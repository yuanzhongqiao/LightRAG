<div class="Box-sc-g0xbh4-0 QkQOb js-snippet-clipboard-copy-unpositioned undefined" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="111295743" _msthash="262">🚀 LightRAG：简单快速的检索增强一代</h2><a id="user-content--lightrag-simple-and-fast-retrieval-augmented-generation" class="anchor" aria-label="永久链接：🚀 LightRAG：简单快速的检索增强生成" href="#-lightrag-simple-and-fast-retrieval-augmented-generation" _mstaria-label="28638181" _msthash="263"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div align="center" dir="auto">
<markdown-accessiblity-table data-catalyst=""><table border="0" width="100%">
<tbody><tr>
<td width="100" align="center">
<a target="_blank" rel="noopener noreferrer" href="https://github.com/user-attachments/assets/cb5b8fc1-0859-4f7c-8ec3-63c8ec7aa54b"><img src="https://github.com/user-attachments/assets/cb5b8fc1-0859-4f7c-8ec3-63c8ec7aa54b" width="80" height="80" alt="莱特拉格" style="max-width: 100%;" _mstalt="115830" _msthash="264"></a>
</td>
<td>
<div dir="auto">
    <p dir="auto">
        <a href="https://lightrag.github.io" rel="nofollow"><img src="https://camo.githubusercontent.com/bf3933961c03cc78ffde90f26e4a3376b69d4efd5b7c54936d89419b6085c055/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f50726f6a6563742d506167652d477265656e" data-canonical-src="https://img.shields.io/badge/Project-Page-Green" style="max-width: 100%;"></a>
        <a href="https://youtu.be/oageL-1I0GE" rel="nofollow"><img src="https://camo.githubusercontent.com/9c0743f0b8d19de24e97aea157e76b9b4d48a5e7cd96a2378fcd8c0dd9e0a820/68747470733a2f2f6261646765732e616c65656e34322e636f6d2f7372632f796f75747562652e737667" data-canonical-src="https://badges.aleen42.com/src/youtube.svg" style="max-width: 100%;"></a>
        <a href="https://arxiv.org/abs/2410.05779" rel="nofollow"><img src="https://camo.githubusercontent.com/75124114ae539f960521098bc31b590246873173eef5b4329622b55ceda6788b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f61725869762d323431302e30353737392d623331623162" data-canonical-src="https://img.shields.io/badge/arXiv-2410.05779-b31b1b" style="max-width: 100%;"></a>
        <a href="https://learnopencv.com/lightrag" rel="nofollow"><img src="https://camo.githubusercontent.com/5271c193c9d3c73535c61967f3d5cf5a1a06dfb74d64ba68899c72c4430dffb7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6561726e4f70656e43562d626c7565" data-canonical-src="https://img.shields.io/badge/LearnOpenCV-blue" style="max-width: 100%;"></a>
    </p>
    <p dir="auto">
        <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/abd492053c71c0ae6bd17e96559e53590c59850bb28609652eb4f8ac240b9a22/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f686b7564732f6c696768747261673f636f6c6f723d677265656e267374796c653d736f6369616c"><img src="https://camo.githubusercontent.com/abd492053c71c0ae6bd17e96559e53590c59850bb28609652eb4f8ac240b9a22/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f686b7564732f6c696768747261673f636f6c6f723d677265656e267374796c653d736f6369616c" data-canonical-src="https://img.shields.io/github/stars/hkuds/lightrag?color=green&amp;style=social" style="max-width: 100%;"></a>
        <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1285b1059a69a51878dfb49eb0fbac318730acd72b2f04f6b6e807e5f40be74d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e31302d626c7565"><img src="https://camo.githubusercontent.com/1285b1059a69a51878dfb49eb0fbac318730acd72b2f04f6b6e807e5f40be74d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e31302d626c7565" data-canonical-src="https://img.shields.io/badge/python-3.10-blue" style="max-width: 100%;"></a>
        <a href="https://pypi.org/project/lightrag-hku/" rel="nofollow"><img src="https://camo.githubusercontent.com/4094352f409b6b46f908f41ec227ff914ae1068c8ee9ab4149b82a67987f3bfa/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6c696768747261672d686b752e737667" data-canonical-src="https://img.shields.io/pypi/v/lightrag-hku.svg" style="max-width: 100%;"></a>
        <a href="https://pepy.tech/project/lightrag-hku" rel="nofollow"><img src="https://camo.githubusercontent.com/9070137fb166fcab2fe65a568b0a54744a67128e485b60b810c93ca11eb8300f/68747470733a2f2f7374617469632e706570792e746563682f62616467652f6c696768747261672d686b752f6d6f6e7468" data-canonical-src="https://static.pepy.tech/badge/lightrag-hku/month" style="max-width: 100%;"></a>
    </p>
    <p dir="auto">
        <a href="https://discord.gg/yF2MmDJyGJ" rel="nofollow"><img src="https://camo.githubusercontent.com/9a5dd24429c18847a68aea872315cdcbec0eae9481e42df36fa407ce2bdfd8f7/68747470733a2f2f646973636f72646170702e636f6d2f6170692f6775696c64732f313239363334383039383030333733343632392f7769646765742e706e673f7374796c653d736869656c64" data-canonical-src="https://discordapp.com/api/guilds/1296348098003734629/widget.png?style=shield" style="max-width: 100%;"></a>
        <a href="https://github.com/HKUDS/LightRAG/issues/285" data-hovercard-type="issue" data-hovercard-url="/HKUDS/LightRAG/issues/285/hovercard"><img src="https://camo.githubusercontent.com/609a2c89a6c6be9dea60f008e7b9301bd7b0b74493a70bd1f27aad4cbd5ff529/68747470733a2f2f696d672e736869656c64732e696f2f62616467652fe7bea4e8818a2d7765636861742d677265656e" data-canonical-src="https://img.shields.io/badge/群聊-wechat-green" style="max-width: 100%;"></a>
    </p>
</div>
</td>
</tr>
</tbody></table></markdown-accessiblity-table>
<div align="center" dir="auto"><font _mstmutation="1" _msttexthash="131889043" _msthash="266">此存储库托管 LightRAG 的代码。此代码的结构基于 <a href="https://github.com/gusye1234/nano-graphrag" _mstmutation="1" _istranslated="1">nano-graphrag</a>。</font><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/054a656498dc5e6890e4ec2ec7e0444fa754051d652642e1bf8ad529762c7012/68747470733a2f2f692d626c6f672e6373646e696d672e636e2f6469726563742f62326161663633343135316234373036383932363933666662343364393039332e706e67"><img src="https://camo.githubusercontent.com/054a656498dc5e6890e4ec2ec7e0444fa754051d652642e1bf8ad529762c7012/68747470733a2f2f692d626c6f672e6373646e696d672e636e2f6469726563742f62326161663633343135316234373036383932363933666662343364393039332e706e67" width="800" alt="LightRAG 图" data-canonical-src="https://i-blog.csdnimg.cn/direct/b2aaf634151b4706892693ffb43d9093.png" style="max-width: 100%;" _mstalt="260468" _msthash="265"></a>
</div>
</div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="19025890" _msthash="267">🎉 新闻</h2><a id="user-content--news" class="anchor" aria-label="永久链接： 🎉 新闻" href="#-news" _mstaria-label="25881934" _msthash="268"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="288227576" _msthash="269">[2025.02.05]🎯📢我们的团队发布了 <a href="https://github.com/HKUDS/VideoRAG" _mstmutation="1" _istranslated="1">VideoRAG</a> 理解超长背景视频。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="321206743" _msthash="270">[2025.01.13]🎯📢我们的团队发布了 <a href="https://github.com/HKUDS/MiniRAG" _mstmutation="1" _istranslated="1">MiniRAG</a>，让小型号的 RAG 变得更简单。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="186436432" _msthash="271">[2025.01.06] 🎯📢您现在可以<a href="#using-postgresql-for-storage" _mstmutation="1" _istranslated="1">使用 PostgreSQL 进行存储</a>。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="218136139" _msthash="272">[2024.12.31] 🎯📢LightRAG 现在支持<a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#delete" _mstmutation="1" _istranslated="1">按文档 ID 进行删除</a>。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="776940905" _msthash="273">[2024.11.25]🎯📢LightRAG 现在支持自定义<a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#insert-custom-kg" _mstmutation="1" _istranslated="1">知识图谱</a>的无缝集成，使用户能够使用自己的领域专业知识来增强系统。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="380026517" _msthash="274">[2024.11.19]🎯📢<a href="https://learnopencv.com/lightrag" rel="nofollow" _mstmutation="1" _istranslated="1">LearnOpenCV</a> 上现已提供 LightRAG 的综合指南。非常感谢博客作者。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="371345442" _msthash="275">[2024.11.12]🎯📢LightRAG 现在支持<a href="https://github.com/HKUDS/LightRAG/blob/main/examples/lightrag_oracle_demo.py" _mstmutation="1" _istranslated="1">所有存储类型（KV、向量和图形）的 Oracle Database 23ai</a>。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="225109898" _msthash="276">[2024.11.11]🎯📢LightRAG 现在支持<a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#delete" _mstmutation="1" _istranslated="1">按实体名称删除实体</a>。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="382471544" _msthash="277">[2024.11.09]🎯📢介绍 <a href="https://lightrag-gui.streamlit.app" rel="nofollow" _mstmutation="1" _istranslated="1">LightRAG Gui</a>，允许您插入、查询、可视化和下载 LightRAG 知识。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="177848996" _msthash="278">[2024.11.04] 🎯📢您现在可以<a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#using-neo4j-for-storage" _mstmutation="1" _istranslated="1">使用 Neo4J 进行存储</a>。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="442030628" _msthash="279">[2024.10.29]🎯📢LightRAG 现在支持多种文件类型，包括 PDF、DOC、PPT 和 CSV （通过 ）。</font><code>textract</code></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="314038777" _msthash="280">[2024.10.20]🎯📢我们在 LightRAG 中添加了一项新功能：图形可视化。</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="352796925" _msthash="281">[2024.10.18]🎯📢我们添加了指向 <a href="https://youtu.be/oageL-1I0GE" rel="nofollow" _mstmutation="1" _istranslated="1">LightRAG 介绍视频</a>的链接。感谢作者！</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="479151439" _msthash="282">[2024.10.17]🎯📢我们创建了 <a href="https://discord.gg/yF2MmDJyGJ" rel="nofollow" _mstmutation="1" _istranslated="1">Discord 频道</a>！欢迎加入分享和讨论！🎉🎉</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="167236420" _msthash="283">[2024.10.16]🎯📢LightRAG 现在支持 <a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#quick-start" _mstmutation="1" _istranslated="1">Ollama 模型</a>！</font></li>
<li class="task-list-item"><input type="checkbox" id="" disabled="" class="task-list-item-checkbox" checked=""><font _mstmutation="1" _msttexthash="174971537" _msthash="284">[2024.10.15]🎯📢LightRAG 现在支持 <a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#quick-start" _mstmutation="1" _istranslated="1">Hugging Face 模型</a>！</font></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="16295266" _msthash="285">算法流程图</h2><a id="user-content-algorithm-flowchart" class="anchor" aria-label="永久链接：算法流程图" href="#algorithm-flowchart" _mstaria-label="772239" _msthash="286"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/fa79bd2d317163583e8acdeb7c28b16d10652cfcd92c4bab85cc00954ffb1888/68747470733a2f2f6c6561726e6f70656e63762e636f6d2f77702d636f6e74656e742f75706c6f6164732f323032342f31312f4c696768745241472d566563746f7244422d4a736f6e2d4b562d53746f72652d496e646578696e672d466c6f7763686172742d7363616c65642e6a7067"><img src="https://camo.githubusercontent.com/fa79bd2d317163583e8acdeb7c28b16d10652cfcd92c4bab85cc00954ffb1888/68747470733a2f2f6c6561726e6f70656e63762e636f6d2f77702d636f6e74656e742f75706c6f6164732f323032342f31312f4c696768745241472d566563746f7244422d4a736f6e2d4b562d53746f72652d496e646578696e672d466c6f7763686172742d7363616c65642e6a7067" alt="LightRAG 索引流程图" data-canonical-src="https://learnopencv.com/wp-content/uploads/2024/11/LightRAG-VectorDB-Json-KV-Store-Indexing-Flowchart-scaled.jpg" style="max-width: 100%;" _mstalt="627276" _msthash="287"></a>
<font _mstmutation="1" _msttexthash="427396255" _msthash="289"><em _mstmutation="1" _istranslated="1">图 1：LightRAG 索引流程图 - img 标题：<a href="https://learnopencv.com/lightrag/" rel="nofollow" _istranslated="1">来源</a></em><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/32d67fdd28040d24756373fc674cae593b9961c2ef84fb8a0a8104f33735ab2a/68747470733a2f2f6c6561726e6f70656e63762e636f6d2f77702d636f6e74656e742f75706c6f6164732f323032342f31312f4c696768745241472d5175657279696e672d466c6f7763686172742d4475616c2d4c6576656c2d52657472696576616c2d47656e65726174696f6e2d4b6e6f776c656467652d4772617068732d7363616c65642e6a7067" _mstmutation="1" _istranslated="1"><img src="https://camo.githubusercontent.com/32d67fdd28040d24756373fc674cae593b9961c2ef84fb8a0a8104f33735ab2a/68747470733a2f2f6c6561726e6f70656e63762e636f6d2f77702d636f6e74656e742f75706c6f6164732f323032342f31312f4c696768745241472d5175657279696e672d466c6f7763686172742d4475616c2d4c6576656c2d52657472696576616c2d47656e65726174696f6e2d4b6e6f776c656467652d4772617068732d7363616c65642e6a7067" alt="LightRAG 检索和查询流程图" data-canonical-src="https://learnopencv.com/wp-content/uploads/2024/11/LightRAG-Querying-Flowchart-Dual-Level-Retrieval-Generation-Knowledge-Graphs-scaled.jpg" style="max-width: 100%;" _mstalt="1246609" _msthash="288" _istranslated="1"></a>图 <em _mstmutation="1" _istranslated="1">2：LightRAG 检索和查询流程图 - img 标题：<a href="https://learnopencv.com/lightrag/" rel="nofollow" _istranslated="1">来源</a></em></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="5773755" _msthash="290">安装</h2><a id="user-content-install" class="anchor" aria-label="永久链接：安装" href="#install" _mstaria-label="336804" _msthash="291"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li _msttexthash="39425971" _msthash="292">从源安装 （Recommend）</li>
</ul>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c1">cd</span> LightRAG
pip install -e <span class="pl-c1">.</span></pre><div class="zeroclipboard-container">
    
  </div></div>
<ul dir="auto">
<li _msttexthash="11451895" _msthash="293">从 PyPI 安装</li>
</ul>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>pip install lightrag-hku</pre><div class="zeroclipboard-container">
    
  </div></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="11905335" _msthash="294">快速开始</h2><a id="user-content-quick-start" class="anchor" aria-label="永久链接：快速入门" href="#quick-start" _mstaria-label="437814" _msthash="295"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li _msttexthash="68174574" _msthash="296">在本地运行 LightRAG <a href="https://www.youtube.com/watch?v=g21royNJ4fw" rel="nofollow" _istranslated="1">的视频演示</a>。</li>
<li><font _mstmutation="1" _msttexthash="44195112" _msthash="297">所有代码都可以在 中找到。</font><code>examples</code></li>
<li><font _mstmutation="1" _msttexthash="160004416" _msthash="298">如果使用 OpenAI 模型，请在环境中设置 OpenAI API 密钥：</font><code>export OPENAI_API_KEY="sk-...".</code></li>
<li _msttexthash="129448839" _msthash="299">下载演示文本“查尔斯·狄更斯的圣诞颂歌”：</li>
</ul>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>curl https://raw.githubusercontent.com/gusye1234/nano-graphrag/main/tests/mock_data.txt <span class="pl-k">&gt;</span> ./book.txt</pre><div class="zeroclipboard-container">
    
  </div></div>
<p dir="auto" _msttexthash="229945053" _msthash="300">使用以下 Python 代码段（在脚本中）初始化 LightRAG 并执行查询：</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-s1">os</span>
<span class="pl-k">from</span> <span class="pl-s1">lightrag</span> <span class="pl-k">import</span> <span class="pl-v">LightRAG</span>, <span class="pl-v">QueryParam</span>
<span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">llm</span>.<span class="pl-s1">openai</span> <span class="pl-k">import</span> <span class="pl-s1">gpt_4o_mini_complete</span>, <span class="pl-s1">gpt_4o_complete</span>

<span class="pl-c">#########</span>
<span class="pl-c"># Uncomment the below two lines if running in a jupyter notebook to handle the async nature of rag.insert()</span>
<span class="pl-c"># import nest_asyncio</span>
<span class="pl-c"># nest_asyncio.apply()</span>
<span class="pl-c">#########</span>

<span class="pl-c1">WORKING_DIR</span> <span class="pl-c1">=</span> <span class="pl-s">"./dickens"</span>


<span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">exists</span>(<span class="pl-c1">WORKING_DIR</span>):
    <span class="pl-s1">os</span>.<span class="pl-c1">mkdir</span>(<span class="pl-c1">WORKING_DIR</span>)

<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">gpt_4o_mini_complete</span>  <span class="pl-c"># Use gpt_4o_mini_complete LLM model</span>
    <span class="pl-c"># llm_model_func=gpt_4o_complete  # Optionally, use a stronger model</span>
)

<span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s">"./book.txt"</span>) <span class="pl-k">as</span> <span class="pl-s1">f</span>:
    <span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>(<span class="pl-s1">f</span>.<span class="pl-c1">read</span>())

<span class="pl-c"># Perform naive search</span>
<span class="pl-en">print</span>(<span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(<span class="pl-s">"What are the top themes in this story?"</span>, <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(<span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"naive"</span>)))

<span class="pl-c"># Perform local search</span>
<span class="pl-en">print</span>(<span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(<span class="pl-s">"What are the top themes in this story?"</span>, <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(<span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"local"</span>)))

<span class="pl-c"># Perform global search</span>
<span class="pl-en">print</span>(<span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(<span class="pl-s">"What are the top themes in this story?"</span>, <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(<span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"global"</span>)))

<span class="pl-c"># Perform hybrid search</span>
<span class="pl-en">print</span>(<span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(<span class="pl-s">"What are the top themes in this story?"</span>, <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(<span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"hybrid"</span>)))

<span class="pl-c"># Perform mix search (Knowledge Graph + Vector Retrieval)</span>
<span class="pl-c"># Mix mode combines knowledge graph and vector search:</span>
<span class="pl-c"># - Uses both structured (KG) and unstructured (vector) information</span>
<span class="pl-c"># - Provides comprehensive answers by analyzing relationships and context</span>
<span class="pl-c"># - Supports image content through HTML img tags</span>
<span class="pl-c"># - Allows control over retrieval depth via top_k parameter</span>
<span class="pl-en">print</span>(<span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(<span class="pl-s">"What are the top themes in this story?"</span>, <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(
    <span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"mix"</span>)))</pre><div class="zeroclipboard-container">
    
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="29072966" _msthash="301">对话历史记录支持</h3><a id="user-content-conversation-history-support" class="anchor" aria-label="永久链接：对话历史记录支持" href="#conversation-history-support" _mstaria-label="1227161" _msthash="302"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="294178573" _msthash="303">LightRAG 现在通过对话历史记录功能支持多回合对话。以下是如何使用它：</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">lightrag</span> <span class="pl-k">import</span> <span class="pl-v">LightRAG</span>, <span class="pl-v">QueryParam</span>

<span class="pl-c"># Initialize LightRAG</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(<span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>)

<span class="pl-c"># Create conversation history</span>
<span class="pl-s1">conversation_history</span> <span class="pl-c1">=</span> [
    {<span class="pl-s">"role"</span>: <span class="pl-s">"user"</span>, <span class="pl-s">"content"</span>: <span class="pl-s">"What is the main character's attitude towards Christmas?"</span>},
    {<span class="pl-s">"role"</span>: <span class="pl-s">"assistant"</span>, <span class="pl-s">"content"</span>: <span class="pl-s">"At the beginning of the story, Ebenezer Scrooge has a very negative attitude towards Christmas..."</span>},
    {<span class="pl-s">"role"</span>: <span class="pl-s">"user"</span>, <span class="pl-s">"content"</span>: <span class="pl-s">"How does his attitude change?"</span>}
]

<span class="pl-c"># Create query parameters with conversation history</span>
<span class="pl-s1">query_param</span> <span class="pl-c1">=</span> <span class="pl-en">QueryParam</span>(
    <span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"mix"</span>,  <span class="pl-c"># or any other mode: "local", "global", "hybrid"</span>
    <span class="pl-s1">conversation_history</span><span class="pl-c1">=</span><span class="pl-s1">conversation_history</span>,  <span class="pl-c"># Add the conversation history</span>
    <span class="pl-s1">history_turns</span><span class="pl-c1">=</span><span class="pl-c1">3</span>  <span class="pl-c"># Number of recent conversation turns to consider</span>
)

<span class="pl-c"># Make a query that takes into account the conversation history</span>
<span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(
    <span class="pl-s">"What causes this change in his character?"</span>,
    <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-s1">query_param</span>
)</pre><div class="zeroclipboard-container">
    
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="23893870" _msthash="304">自定义提示支持</h3><a id="user-content-custom-prompt-support" class="anchor" aria-label="永久链接：自定义提示支持" href="#custom-prompt-support" _mstaria-label="842309" _msthash="305"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="373296807" _msthash="306">LightRAG 现在支持自定义提示，以便对系统行为进行微调控制。以下是如何使用它：</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">lightrag</span> <span class="pl-k">import</span> <span class="pl-v">LightRAG</span>, <span class="pl-v">QueryParam</span>

<span class="pl-c"># Initialize LightRAG</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(<span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>)

<span class="pl-c"># Create query parameters</span>
<span class="pl-s1">query_param</span> <span class="pl-c1">=</span> <span class="pl-en">QueryParam</span>(
    <span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"hybrid"</span>,  <span class="pl-c"># or other mode: "local", "global", "hybrid"</span>
)

<span class="pl-c"># Example 1: Using the default system prompt</span>
<span class="pl-s1">response_default</span> <span class="pl-c1">=</span> <span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(
    <span class="pl-s">"What are the primary benefits of renewable energy?"</span>,
    <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-s1">query_param</span>
)
<span class="pl-en">print</span>(<span class="pl-s1">response_default</span>)

<span class="pl-c"># Example 2: Using a custom prompt</span>
<span class="pl-s1">custom_prompt</span> <span class="pl-c1">=</span> <span class="pl-s">"""</span>
<span class="pl-s">You are an expert assistant in environmental science. Provide detailed and structured answers with examples.</span>
<span class="pl-s">"""</span>
<span class="pl-s1">response_custom</span> <span class="pl-c1">=</span> <span class="pl-s1">rag</span>.<span class="pl-c1">query</span>(
    <span class="pl-s">"What are the primary benefits of renewable energy?"</span>,
    <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-s1">query_param</span>,
    <span class="pl-s1">prompt</span><span class="pl-c1">=</span><span class="pl-s1">custom_prompt</span>  <span class="pl-c"># Pass the custom prompt</span>
)
<span class="pl-en">print</span>(<span class="pl-s1">response_custom</span>)</pre><div class="zeroclipboard-container">
   
  </div></div>
<details>
<summary _msttexthash="18189275" _msthash="307">使用类似 Open AI 的 API</summary>
<ul dir="auto">
<li _msttexthash="108518774" _msthash="308">LightRAG 还支持类似 Open AI 的聊天/嵌入 API：</li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">llm_model_func</span>(
    <span class="pl-s1">prompt</span>, <span class="pl-s1">system_prompt</span><span class="pl-c1">=</span><span class="pl-c1">None</span>, <span class="pl-s1">history_messages</span><span class="pl-c1">=</span>[], <span class="pl-s1">keyword_extraction</span><span class="pl-c1">=</span><span class="pl-c1">False</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>
) <span class="pl-c1">-&gt;</span> <span class="pl-smi">str</span>:
    <span class="pl-k">return</span> <span class="pl-k">await</span> <span class="pl-en">openai_complete_if_cache</span>(
        <span class="pl-s">"solar-mini"</span>,
        <span class="pl-s1">prompt</span>,
        <span class="pl-s1">system_prompt</span><span class="pl-c1">=</span><span class="pl-s1">system_prompt</span>,
        <span class="pl-s1">history_messages</span><span class="pl-c1">=</span><span class="pl-s1">history_messages</span>,
        <span class="pl-s1">api_key</span><span class="pl-c1">=</span><span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">"UPSTAGE_API_KEY"</span>),
        <span class="pl-s1">base_url</span><span class="pl-c1">=</span><span class="pl-s">"https://api.upstage.ai/v1/solar"</span>,
        <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>
    )

<span class="pl-k">async</span> <span class="pl-k">def</span> <span class="pl-en">embedding_func</span>(<span class="pl-s1">texts</span>: <span class="pl-s1">list</span>[<span class="pl-smi">str</span>]) <span class="pl-c1">-&gt;</span> <span class="pl-s1">np</span>.<span class="pl-c1">ndarray</span>:
    <span class="pl-k">return</span> <span class="pl-k">await</span> <span class="pl-en">openai_embed</span>(
        <span class="pl-s1">texts</span>,
        <span class="pl-s1">model</span><span class="pl-c1">=</span><span class="pl-s">"solar-embedding-1-large-query"</span>,
        <span class="pl-s1">api_key</span><span class="pl-c1">=</span><span class="pl-s1">os</span>.<span class="pl-c1">getenv</span>(<span class="pl-s">"UPSTAGE_API_KEY"</span>),
        <span class="pl-s1">base_url</span><span class="pl-c1">=</span><span class="pl-s">"https://api.upstage.ai/v1/solar"</span>
    )

<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">llm_model_func</span>,
    <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
        <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-c1">4096</span>,
        <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
        <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-s1">embedding_func</span>
    )
)</pre><div class="zeroclipboard-container">
 
  </div></div>
</details>
<details>
<summary _msttexthash="18349643" _msthash="309">使用 Hugging Face 模型</summary>
<ul dir="auto">
<li _msttexthash="207201072" _msthash="310">如果您想使用 Hugging Face 模型，您只需按如下方式设置 LightRAG：</li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">llm</span> <span class="pl-k">import</span> <span class="pl-s1">hf_model_complete</span>, <span class="pl-s1">hf_embedding</span>
<span class="pl-k">from</span> <span class="pl-s1">transformers</span> <span class="pl-k">import</span> <span class="pl-v">AutoModel</span>, <span class="pl-v">AutoTokenizer</span>
<span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">utils</span> <span class="pl-k">import</span> <span class="pl-v">EmbeddingFunc</span>

<span class="pl-c"># Initialize LightRAG with Hugging Face model</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">hf_model_complete</span>,  <span class="pl-c"># Use Hugging Face model for text generation</span>
    <span class="pl-s1">llm_model_name</span><span class="pl-c1">=</span><span class="pl-s">'meta-llama/Llama-3.1-8B-Instruct'</span>,  <span class="pl-c"># Model name from Hugging Face</span>
    <span class="pl-c"># Use Hugging Face embedding function</span>
    <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
        <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-c1">384</span>,
        <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">5000</span>,
        <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-k">lambda</span> <span class="pl-s1">texts</span>: <span class="pl-en">hf_embedding</span>(
            <span class="pl-s1">texts</span>,
            <span class="pl-s1">tokenizer</span><span class="pl-c1">=</span><span class="pl-v">AutoTokenizer</span>.<span class="pl-c1">from_pretrained</span>(<span class="pl-s">"sentence-transformers/all-MiniLM-L6-v2"</span>),
            <span class="pl-s1">embed_model</span><span class="pl-c1">=</span><span class="pl-v">AutoModel</span>.<span class="pl-c1">from_pretrained</span>(<span class="pl-s">"sentence-transformers/all-MiniLM-L6-v2"</span>)
        )
    ),
)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from lightrag.llm import hf_model_complete, hf_embedding
from transformers import AutoModel, AutoTokenizer
from lightrag.utils import EmbeddingFunc

# Initialize LightRAG with Hugging Face model
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=hf_model_complete,  # Use Hugging Face model for text generation
    llm_model_name='meta-llama/Llama-3.1-8B-Instruct',  # Model name from Hugging Face
    # Use Hugging Face embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=384,
        max_token_size=5000,
        func=lambda texts: hf_embedding(
            texts,
            tokenizer=AutoTokenizer.from_pretrained(&quot;sentence-transformers/all-MiniLM-L6-v2&quot;),
            embed_model=AutoModel.from_pretrained(&quot;sentence-transformers/all-MiniLM-L6-v2&quot;)
        )
    ),
)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details open="">
<summary _msttexthash="15020486" _msthash="311">使用 Ollama 模型</summary>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="6290102" _msthash="312">概述</h3><a id="user-content-overview" class="anchor" aria-label="永久链接： 概述" href="#overview" _mstaria-label="375934" _msthash="313"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="287948336" _msthash="314">如果你想使用 Ollama 模型，你需要拉取你打算使用的模型和嵌入模型，例如 .</font><code>nomic-embed-text</code></p>
<p dir="auto" _msttexthash="68106857" _msthash="315">那么你只需要设置 LightRAG 如下：</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">llm</span>.<span class="pl-s1">ollama</span> <span class="pl-k">import</span> <span class="pl-s1">ollama_model_complete</span>, <span class="pl-s1">ollama_embed</span>
<span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">utils</span> <span class="pl-k">import</span> <span class="pl-v">EmbeddingFunc</span>

<span class="pl-c"># Initialize LightRAG with Ollama model</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">ollama_model_complete</span>,  <span class="pl-c"># Use Ollama model for text generation</span>
    <span class="pl-s1">llm_model_name</span><span class="pl-c1">=</span><span class="pl-s">'your_model_name'</span>, <span class="pl-c"># Your model name</span>
    <span class="pl-c"># Use Ollama embedding function</span>
    <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
        <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-c1">768</span>,
        <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
        <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-k">lambda</span> <span class="pl-s1">texts</span>: <span class="pl-en">ollama_embed</span>(
            <span class="pl-s1">texts</span>,
            <span class="pl-s1">embed_model</span><span class="pl-c1">=</span><span class="pl-s">"nomic-embed-text"</span>
        )
    ),
)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from lightrag.llm.ollama import ollama_model_complete, ollama_embed
from lightrag.utils import EmbeddingFunc

# Initialize LightRAG with Ollama model
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=ollama_model_complete,  # Use Ollama model for text generation
    llm_model_name='your_model_name', # Your model name
    # Use Ollama embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=768,
        max_token_size=8192,
        func=lambda texts: ollama_embed(
            texts,
            embed_model=&quot;nomic-embed-text&quot;
        )
    ),
)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="20458854" _msthash="316">增加上下文大小</h3><a id="user-content-increasing-context-size" class="anchor" aria-label="永久链接：增加上下文大小" href="#increasing-context-size" _mstaria-label="942227" _msthash="317"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="881776103" _msthash="318">为了使 LightRAG 正常工作，上下文应至少为 32k 令牌。默认情况下，Ollama 模型的上下文大小为 8k。您可以使用以下两种方法之一来实现此目的：</p>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto"><font _mstmutation="1" _msttexthash="32775951" _msthash="319">增加 Modelfile 中的参数。</font><code>num_ctx</code></h4><a id="user-content-increasing-the-num_ctx-parameter-in-modelfile" class="anchor" aria-label="永久链接：在 Modelfile 中增加 num_ctx 参数。" href="#increasing-the-num_ctx-parameter-in-modelfile" _mstaria-label="2176317" _msthash="320"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ol dir="auto">
<li _msttexthash="19964308" _msthash="321">拉取模型：</li>
</ol>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>ollama pull qwen2</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="ollama pull qwen2" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ol start="2" dir="auto">
<li _msttexthash="29608384" _msthash="322">显示模型文件：</li>
</ol>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>ollama show --modelfile qwen2 <span class="pl-k">&gt;</span> Modelfile</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="ollama show --modelfile qwen2 > Modelfile" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ol start="3" dir="auto">
<li _msttexthash="66260519" _msthash="323">通过添加以下行来编辑 Modelfile：</li>
</ol>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>PARAMETER num_ctx 32768</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="PARAMETER num_ctx 32768" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ol start="4" dir="auto">
<li _msttexthash="39419276" _msthash="324">创建修改后的模型：</li>
</ol>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>ollama create -f Modelfile qwen2m</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="ollama create -f Modelfile qwen2m" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto"><font _mstmutation="1" _msttexthash="26944450" _msthash="325">通过 Ollama API 设置。</font><code>num_ctx</code></h4><a id="user-content-setup-num_ctx-via-ollama-api" class="anchor" aria-label="永久链接：通过 Ollama API 设置 num_ctx。" href="#setup-num_ctx-via-ollama-api" _mstaria-label="1055925" _msthash="326"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="63153961" _msthash="327">Tiy 可以使用 param 来配置 ollama：</font><code>llm_model_kwargs</code></p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">ollama_model_complete</span>,  <span class="pl-c"># Use Ollama model for text generation</span>
    <span class="pl-s1">llm_model_name</span><span class="pl-c1">=</span><span class="pl-s">'your_model_name'</span>, <span class="pl-c"># Your model name</span>
    <span class="pl-s1">llm_model_kwargs</span><span class="pl-c1">=</span>{<span class="pl-s">"options"</span>: {<span class="pl-s">"num_ctx"</span>: <span class="pl-c1">32768</span>}},
    <span class="pl-c"># Use Ollama embedding function</span>
    <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
        <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-c1">768</span>,
        <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
        <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-k">lambda</span> <span class="pl-s1">texts</span>: <span class="pl-en">ollama_embedding</span>(
            <span class="pl-s1">texts</span>,
            <span class="pl-s1">embed_model</span><span class="pl-c1">=</span><span class="pl-s">"nomic-embed-text"</span>
        )
    ),
)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=ollama_model_complete,  # Use Ollama model for text generation
    llm_model_name='your_model_name', # Your model name
    llm_model_kwargs={&quot;options&quot;: {&quot;num_ctx&quot;: 32768}},
    # Use Ollama embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=768,
        max_token_size=8192,
        func=lambda texts: ollama_embedding(
            texts,
            embed_model=&quot;nomic-embed-text&quot;
        )
    ),
)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto" _msttexthash="25461124" _msthash="328">功能齐全的示例</h4><a id="user-content-fully-functional-example" class="anchor" aria-label="永久链接：功能齐全的示例" href="#fully-functional-example" _mstaria-label="987506" _msthash="329"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="387640188" _msthash="330">这里有一个功能齐全的示例，它利用模型，仅并行运行 4 个请求，并将上下文大小设置为 32k。</font><code>examples/lightrag_ollama_demo.py</code><code>gemma2:2b</code></p>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto" _msttexthash="78477763" _msthash="331">使用 “Thinking” 模型（例如 DeepSeek）</h4><a id="user-content-using-thinking-models-eg-deepseek" class="anchor" aria-label="永久链接：使用 “Thinking” 模型（例如 DeepSeek）" href="#using-thinking-models-eg-deepseek" _mstaria-label="1567176" _msthash="332"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="73714446" _msthash="333">要仅返回模型的响应，您可以传入 .</font><code>reasoning_tag</code><code>llm_model_kwargs</code></p>
<p dir="auto"><font _mstmutation="1" _msttexthash="89910639" _msthash="334">例如，对于 DeepSeek 模型，应设置为 。</font><code>reasoning_tag</code><code>think</code></p>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto" _msttexthash="1910623" _msthash="335">低 RAM GPU</h4><a id="user-content-low-ram-gpus" class="anchor" aria-label="永久链接：低 RAM GPU" href="#low-ram-gpus" _mstaria-label="392639" _msthash="336"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="2277901067" _msthash="337">为了在低 RAM GPU 上运行此实验，您应该选择小模型并调整上下文窗口（增加上下文会增加内存消耗）。例如，在具有 6GB RAM 的重新利用的挖矿 GPU 上运行此 ollama 示例时，需要在使用 时将上下文大小设置为 26k。它能够在 上找到 上的 197 个实体和 19 个关系。</font><code>gemma2:2b</code><code>book.txt</code></p>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="12029121" _msthash="338">查询参数</h3><a id="user-content-query-param" class="anchor" aria-label="永久链接：Query Param" href="#query-param" _mstaria-label="435422" _msthash="339"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">class</span> <span class="pl-v">QueryParam</span>:
    <span class="pl-s1">mode</span>: <span class="pl-v">Literal</span>[<span class="pl-s">"local"</span>, <span class="pl-s">"global"</span>, <span class="pl-s">"hybrid"</span>, <span class="pl-s">"naive"</span>, <span class="pl-s">"mix"</span>] <span class="pl-c1">=</span> <span class="pl-s">"global"</span>
    <span class="pl-s1">only_need_context</span>: <span class="pl-smi">bool</span> <span class="pl-c1">=</span> <span class="pl-c1">False</span>
    <span class="pl-s1">response_type</span>: <span class="pl-smi">str</span> <span class="pl-c1">=</span> <span class="pl-s">"Multiple Paragraphs"</span>
    <span class="pl-c"># Number of top-k items to retrieve; corresponds to entities in "local" mode and relationships in "global" mode.</span>
    <span class="pl-s1">top_k</span>: <span class="pl-smi">int</span> <span class="pl-c1">=</span> <span class="pl-c1">60</span>
    <span class="pl-c"># Number of tokens for the original chunks.</span>
    <span class="pl-s1">max_token_for_text_unit</span>: <span class="pl-smi">int</span> <span class="pl-c1">=</span> <span class="pl-c1">4000</span>
    <span class="pl-c"># Number of tokens for the relationship descriptions</span>
    <span class="pl-s1">max_token_for_global_context</span>: <span class="pl-smi">int</span> <span class="pl-c1">=</span> <span class="pl-c1">4000</span>
    <span class="pl-c"># Number of tokens for the entity descriptions</span>
    <span class="pl-s1">max_token_for_local_context</span>: <span class="pl-smi">int</span> <span class="pl-c1">=</span> <span class="pl-c1">4000</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="class QueryParam:
    mode: Literal[&quot;local&quot;, &quot;global&quot;, &quot;hybrid&quot;, &quot;naive&quot;, &quot;mix&quot;] = &quot;global&quot;
    only_need_context: bool = False
    response_type: str = &quot;Multiple Paragraphs&quot;
    # Number of top-k items to retrieve; corresponds to entities in &quot;local&quot; mode and relationships in &quot;global&quot; mode.
    top_k: int = 60
    # Number of tokens for the original chunks.
    max_token_for_text_unit: int = 4000
    # Number of tokens for the relationship descriptions
    max_token_for_global_context: int = 4000
    # Number of tokens for the entity descriptions
    max_token_for_local_context: int = 4000" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<blockquote>
<p dir="auto" _msttexthash="99563165" _msthash="340">默认值 Top_k 可以通过环境变量TOP_K来更改。</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="11874655" _msthash="341">批量插入</h3><a id="user-content-batch-insert" class="anchor" aria-label="永久链接：批量插入" href="#batch-insert" _mstaria-label="468494" _msthash="342"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c"># Basic Batch Insert: Insert multiple texts at once</span>
<span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>([<span class="pl-s">"TEXT1"</span>, <span class="pl-s">"TEXT2"</span>,...])

<span class="pl-c"># Batch Insert with custom batch size configuration</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">addon_params</span><span class="pl-c1">=</span>{
        <span class="pl-s">"insert_batch_size"</span>: <span class="pl-c1">20</span>  <span class="pl-c"># Process 20 documents per batch</span>
    }
)
<span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>([<span class="pl-s">"TEXT1"</span>, <span class="pl-s">"TEXT2"</span>, <span class="pl-s">"TEXT3"</span>, ...])  <span class="pl-c"># Documents will be processed in batches of 20</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="# Basic Batch Insert: Insert multiple texts at once
rag.insert([&quot;TEXT1&quot;, &quot;TEXT2&quot;,...])

# Batch Insert with custom batch size configuration
rag = LightRAG(
    working_dir=WORKING_DIR,
    addon_params={
        &quot;insert_batch_size&quot;: 20  # Process 20 documents per batch
    }
)
rag.insert([&quot;TEXT1&quot;, &quot;TEXT2&quot;, &quot;TEXT3&quot;, ...])  # Documents will be processed in batches of 20" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="206614369" _msthash="343">参数 in 控制在插入期间每个批次中处理的文档数。这适用于：</font><code>insert_batch_size</code><code>addon_params</code></p>
<ul dir="auto">
<li _msttexthash="69622930" _msthash="344">管理大型文档集合的内存使用情况</li>
<li _msttexthash="19637969" _msthash="345">优化处理速度</li>
<li _msttexthash="38391860" _msthash="346">提供更好的进度跟踪</li>
<li _msttexthash="51413141" _msthash="347">如果未指定，则默认值为 10</li>
</ul>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="11645062" _msthash="348">增量插入</h3><a id="user-content-incremental-insert" class="anchor" aria-label="永久链接：增量插入" href="#incremental-insert" _mstaria-label="725114" _msthash="349"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c"># Incremental Insert: Insert new documents into an existing LightRAG instance</span>
<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
     <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
     <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">llm_model_func</span>,
     <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
          <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-s1">embedding_dimension</span>,
          <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
          <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-s1">embedding_func</span>,
     ),
)

<span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s">"./newText.txt"</span>) <span class="pl-k">as</span> <span class="pl-s1">f</span>:
    <span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>(<span class="pl-s1">f</span>.<span class="pl-c1">read</span>())</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="# Incremental Insert: Insert new documents into an existing LightRAG instance
rag = LightRAG(
     working_dir=WORKING_DIR,
     llm_model_func=llm_model_func,
     embedding_func=EmbeddingFunc(
          embedding_dim=embedding_dimension,
          max_token_size=8192,
          func=embedding_func,
     ),
)

with open(&quot;./newText.txt&quot;) as f:
    rag.insert(f.read())" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="15629003" _msthash="350">使用 Pipeline 插入</h3><a id="user-content-insert-using-pipeline" class="anchor" aria-label="永久链接：使用 Pipeline 插入" href="#insert-using-pipeline" _mstaria-label="823498" _msthash="351"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="102094135" _msthash="352">的 and 函数允许您将文档增量插入到图形中。</font><code>apipeline_enqueue_documents</code><code>apipeline_process_enqueue_documents</code></p>
<p dir="auto" _msttexthash="262213562" _msthash="353">这对于您希望在后台处理文档同时仍允许主线程继续执行的情况非常有用。</p>
<p dir="auto" _msttexthash="56422392" _msthash="354">并使用例程来处理新闻文档。</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(..)
<span class="pl-k">await</span> <span class="pl-s1">rag</span>.<span class="pl-c1">apipeline_enqueue_documents</span>(<span class="pl-s1">string_or_strings</span>)
<span class="pl-c"># Your routine in loop</span>
<span class="pl-k">await</span> <span class="pl-s1">rag</span>.<span class="pl-c1">apipeline_process_enqueue_documents</span>(<span class="pl-s1">string_or_strings</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="rag = LightRAG(..)
await rag.apipeline_enqueue_documents(string_or_strings)
# Your routine in loop
await rag.apipeline_process_enqueue_documents(string_or_strings)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="28594683" _msthash="355">单独的关键字提取</h3><a id="user-content-separate-keyword-extraction" class="anchor" aria-label="永久链接：单独的关键字提取" href="#separate-keyword-extraction" _mstaria-label="1140763" _msthash="356"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="831152439" _msthash="357">我们引入了一个新功能来增强关键字提取功能。此功能将关键字提取过程与用户的提示分开，仅专注于查询，以提高提取的关键字的相关性。</font><code>query_with_separate_keyword_extraction</code></p>
<div class="markdown-heading" dir="auto"><h5 tabindex="-1" class="heading-element" dir="auto" _msttexthash="30385888" _msthash="358">这个怎么运作？</h5><a id="user-content-how-it-works" class="anchor" aria-label="永久链接：这个怎么运作？" href="#how-it-works" _mstaria-label="458029" _msthash="359"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="105204359" _msthash="360">该函数通过将输入分为两部分来运行：</p>
<ul dir="auto">
<li><code>User Query</code></li>
<li><code>Prompt</code></li>
</ul>
<p dir="auto"><font _mstmutation="1" _msttexthash="754787722" _msthash="361">然后，它专门对 .这种分离可确保提取过程重点突出且相关，不受 .它还允许 纯粹用于响应格式，保持用户原始问题的意图和清晰度。</font><code>user query</code><code>prompt</code><code>prompt</code></p>
<div class="markdown-heading" dir="auto"><h5 tabindex="-1" class="heading-element" dir="auto" _msttexthash="11249277" _msthash="362">使用示例</h5><a id="user-content-usage-example" class="anchor" aria-label="永久链接：使用示例" href="#usage-example" _mstaria-label="504543" _msthash="363"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="283828181" _msthash="364">这展示了如何为教育内容定制功能，重点是为高年级学生提供详细的解释。</font><code>example</code></p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">rag</span>.<span class="pl-c1">query_with_separate_keyword_extraction</span>(
    <span class="pl-s1">query</span><span class="pl-c1">=</span><span class="pl-s">"Explain the law of gravity"</span>,
    <span class="pl-s1">prompt</span><span class="pl-c1">=</span><span class="pl-s">"Provide a detailed explanation suitable for high school students studying physics."</span>,
    <span class="pl-s1">param</span><span class="pl-c1">=</span><span class="pl-en">QueryParam</span>(<span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">"hybrid"</span>)
)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="rag.query_with_separate_keyword_extraction(
    query=&quot;Explain the law of gravity&quot;,
    prompt=&quot;Provide a detailed explanation suitable for high school students studying physics.&quot;,
    param=QueryParam(mode=&quot;hybrid&quot;)
)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="27963390" _msthash="365">使用 Neo4J 进行存储</h3><a id="user-content-using-neo4j-for-storage" class="anchor" aria-label="永久链接：使用 Neo4J 进行存储" href="#using-neo4j-for-storage" _mstaria-label="834496" _msthash="366"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li _msttexthash="134654494" _msthash="367">对于生产级方案，您很可能希望利用企业解决方案</li>
<li _msttexthash="192848864" _msthash="368">用于 KG 存储。建议在 Docker 中运行 Neo4J 以实现无缝的本地测试。</li>
<li _msttexthash="14186640" _msthash="369">另请： <a href="https://hub.docker.com/_/neo4j" rel="nofollow" _istranslated="1">https://hub.docker.com/_/neo4j</a></li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">export</span> <span class="pl-v">NEO4J_URI</span><span class="pl-c1">=</span><span class="pl-s">"neo4j://localhost:7687"</span>
<span class="pl-s1">export</span> <span class="pl-v">NEO4J_USERNAME</span><span class="pl-c1">=</span><span class="pl-s">"neo4j"</span>
<span class="pl-s1">export</span> <span class="pl-v">NEO4J_PASSWORD</span><span class="pl-c1">=</span><span class="pl-s">"password"</span>

<span class="pl-c"># When you launch the project be sure to override the default KG: NetworkX</span>
<span class="pl-c"># by specifying kg="Neo4JStorage".</span>

<span class="pl-c"># Note: Default settings use NetworkX</span>
<span class="pl-c"># Initialize LightRAG with Neo4J implementation.</span>
<span class="pl-c1">WORKING_DIR</span> <span class="pl-c1">=</span> <span class="pl-s">"./local_neo4jWorkDir"</span>

<span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
    <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
    <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">gpt_4o_mini_complete</span>,  <span class="pl-c"># Use gpt_4o_mini_complete LLM model</span>
    <span class="pl-s1">graph_storage</span><span class="pl-c1">=</span><span class="pl-s">"Neo4JStorage"</span>, <span class="pl-c">#&lt;-----------override KG default</span>
    <span class="pl-s1">log_level</span><span class="pl-c1">=</span><span class="pl-s">"DEBUG"</span>  <span class="pl-c">#&lt;-----------override log_level default</span>
)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="export NEO4J_URI=&quot;neo4j://localhost:7687&quot;
export NEO4J_USERNAME=&quot;neo4j&quot;
export NEO4J_PASSWORD=&quot;password&quot;

# When you launch the project be sure to override the default KG: NetworkX
# by specifying kg=&quot;Neo4JStorage&quot;.

# Note: Default settings use NetworkX
# Initialize LightRAG with Neo4J implementation.
WORKING_DIR = &quot;./local_neo4jWorkDir&quot;

rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=gpt_4o_mini_complete,  # Use gpt_4o_mini_complete LLM model
    graph_storage=&quot;Neo4JStorage&quot;, #<-----------override KG default
    log_level=&quot;DEBUG&quot;  #<-----------override log_level default
)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto" _msttexthash="52540150" _msthash="370">有关工作示例，请参阅 test_neo4j.py。</p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="35597588" _msthash="371">使用 PostgreSQL 进行存储</h3><a id="user-content-using-postgresql-for-storage" class="anchor" aria-label="永久链接：使用 PostgreSQL 进行存储" href="#using-postgresql-for-storage" _mstaria-label="1108575" _msthash="372"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="788948732" _msthash="373">对于生产级方案，您很可能希望利用企业解决方案。PostgreSQL 可以为您提供 KV 存储、VectorDB （pgvector） 和 GraphDB （apache AGE） 的一站式解决方案。</p>
<ul dir="auto">
<li _msttexthash="774943806" _msthash="374">PostgreSQL 是轻量级的，包括所有必要的插件在内的整个二进制发行版都可以压缩到 40MB：参考 <a href="https://github.com/ShanGor/apache-age-windows/releases/tag/PG17%2Fv1.5.0-rc0" _istranslated="1">Windows 版本</a>，因为它很容易为 Linux/Mac 安装。</li>
<li _msttexthash="491346011" _msthash="375">如果您更喜欢 docker，如果您是初学者，请从此图像开始，以避免打嗝（请阅读概述）：<a href="https://hub.docker.com/r/shangor/postgres-for-rag" rel="nofollow" _istranslated="1">https://hub.docker.com/r/shangor/postgres-for-rag</a></li>
<li _msttexthash="42018444" _msthash="376">如何开始？参考： <a href="https://github.com/HKUDS/LightRAG/blob/main/examples/lightrag_zhipu_postgres_demo.py" _istranslated="1">examples/lightrag_zhipu_postgres_demo.py</a></li>
<li><font _mstmutation="1" _msttexthash="294835632" _msthash="377">为 AGE 创建索引示例：（如有必要，请将以下内容更改为您的图表名称）</font><code>dickens</code><div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto"><pre>load <span class="pl-s"><span class="pl-pds">'</span>age<span class="pl-pds">'</span></span>;
<span class="pl-k">SET</span> search_path <span class="pl-k">=</span> ag_catalog, <span class="pl-s"><span class="pl-pds">"</span>$user<span class="pl-pds">"</span></span>, public;
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> entity_p_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>Entity<span class="pl-pds">"</span></span> (id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> vertex_p_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_vertex<span class="pl-pds">"</span></span> (id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> directed_p_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>DIRECTED<span class="pl-pds">"</span></span> (id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> directed_eid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>DIRECTED<span class="pl-pds">"</span></span> (end_id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> directed_sid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>DIRECTED<span class="pl-pds">"</span></span> (start_id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> directed_seid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>DIRECTED<span class="pl-pds">"</span></span> (start_id,end_id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> edge_p_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_edge<span class="pl-pds">"</span></span> (id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> edge_sid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_edge<span class="pl-pds">"</span></span> (start_id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> edge_eid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_edge<span class="pl-pds">"</span></span> (end_id);
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> edge_seid_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_edge<span class="pl-pds">"</span></span> (start_id,end_id);
<span class="pl-k">create</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> vertex_idx_node_id <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>_ag_label_vertex<span class="pl-pds">"</span></span> (<span class="pl-c1">ag_catalog</span>.<span class="pl-c1">agtype_access_operator</span>(properties, <span class="pl-s"><span class="pl-pds">'</span>"node_id"<span class="pl-pds">'</span></span>::agtype));
<span class="pl-k">create</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> entity_idx_node_id <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>Entity<span class="pl-pds">"</span></span> (<span class="pl-c1">ag_catalog</span>.<span class="pl-c1">agtype_access_operator</span>(properties, <span class="pl-s"><span class="pl-pds">'</span>"node_id"<span class="pl-pds">'</span></span>::agtype));
<span class="pl-k">CREATE</span> <span class="pl-k">INDEX</span> <span class="pl-en">CONCURRENTLY</span> entity_node_id_gin_idx <span class="pl-k">ON</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>Entity<span class="pl-pds">"</span></span> using gin(properties);
<span class="pl-k">ALTER</span> <span class="pl-k">TABLE</span> dickens.<span class="pl-s"><span class="pl-pds">"</span>DIRECTED<span class="pl-pds">"</span></span> CLUSTER <span class="pl-k">ON</span> directed_sid_idx;

<span class="pl-c"><span class="pl-c">--</span> drop if necessary</span>
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> entity_p_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> vertex_p_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> directed_p_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> directed_eid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> directed_sid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> directed_seid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> edge_p_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> edge_sid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> edge_eid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> edge_seid_idx;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> vertex_idx_node_id;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> entity_idx_node_id;
<span class="pl-k">drop</span> <span class="pl-k">INDEX</span> entity_node_id_gin_idx;</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="load 'age';
SET search_path = ag_catalog, &quot;$user&quot;, public;
CREATE INDEX CONCURRENTLY entity_p_idx ON dickens.&quot;Entity&quot; (id);
CREATE INDEX CONCURRENTLY vertex_p_idx ON dickens.&quot;_ag_label_vertex&quot; (id);
CREATE INDEX CONCURRENTLY directed_p_idx ON dickens.&quot;DIRECTED&quot; (id);
CREATE INDEX CONCURRENTLY directed_eid_idx ON dickens.&quot;DIRECTED&quot; (end_id);
CREATE INDEX CONCURRENTLY directed_sid_idx ON dickens.&quot;DIRECTED&quot; (start_id);
CREATE INDEX CONCURRENTLY directed_seid_idx ON dickens.&quot;DIRECTED&quot; (start_id,end_id);
CREATE INDEX CONCURRENTLY edge_p_idx ON dickens.&quot;_ag_label_edge&quot; (id);
CREATE INDEX CONCURRENTLY edge_sid_idx ON dickens.&quot;_ag_label_edge&quot; (start_id);
CREATE INDEX CONCURRENTLY edge_eid_idx ON dickens.&quot;_ag_label_edge&quot; (end_id);
CREATE INDEX CONCURRENTLY edge_seid_idx ON dickens.&quot;_ag_label_edge&quot; (start_id,end_id);
create INDEX CONCURRENTLY vertex_idx_node_id ON dickens.&quot;_ag_label_vertex&quot; (ag_catalog.agtype_access_operator(properties, '&quot;node_id&quot;'::agtype));
create INDEX CONCURRENTLY entity_idx_node_id ON dickens.&quot;Entity&quot; (ag_catalog.agtype_access_operator(properties, '&quot;node_id&quot;'::agtype));
CREATE INDEX CONCURRENTLY entity_node_id_gin_idx ON dickens.&quot;Entity&quot; using gin(properties);
ALTER TABLE dickens.&quot;DIRECTED&quot; CLUSTER ON directed_sid_idx;

-- drop if necessary
drop INDEX entity_p_idx;
drop INDEX vertex_p_idx;
drop INDEX directed_p_idx;
drop INDEX directed_eid_idx;
drop INDEX directed_sid_idx;
drop INDEX directed_seid_idx;
drop INDEX edge_p_idx;
drop INDEX edge_sid_idx;
drop INDEX edge_eid_idx;
drop INDEX edge_seid_idx;
drop INDEX vertex_idx_node_id;
drop INDEX entity_idx_node_id;
drop INDEX entity_node_id_gin_idx;" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</li>
<li><font _mstmutation="1" _msttexthash="202528846" _msthash="378">Apache AGE 的已知问题：已发布的版本出现以下问题：</font><blockquote>
<p dir="auto" _msttexthash="232366121" _msthash="379">您可能会发现节点 / 边的属性为空。
这是正式版的一个已知问题：<a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="2226727319" data-permission-text="Title is private" data-url="https://github.com/apache/age/issues/1721" data-hovercard-type="pull_request" data-hovercard-url="/apache/age/pull/1721/hovercard" href="https://github.com/apache/age/pull/1721" _istranslated="1">apache/age#1721</a></p>
<p dir="auto" _msttexthash="62699429" _msthash="380">您可以从源代码编译 AGE 并修复它。</p>
</blockquote>
</li>
</ul>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="27977833" _msthash="381">使用 Faiss 进行存储</h3><a id="user-content-using-faiss-for-storage" class="anchor" aria-label="永久链接：使用 Faiss 进行存储" href="#using-faiss-for-storage" _mstaria-label="863473" _msthash="382"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li _msttexthash="47213309" _msthash="383">安装所需的依赖项：</li>
</ul>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>pip install faiss-cpu
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="pip install faiss-cpu" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="68058692" _msthash="384">如果您有 GPU 支持，也可以安装。</font><code>faiss-gpu</code></p>
<ul dir="auto">
<li><font _mstmutation="1" _msttexthash="156746460" _msthash="385">这里我们使用的是 model，但您也可以使用带有维度的 model。</font><code>sentence-transformers</code><code>OpenAIEmbedding</code><code>3072</code></li>
</ul>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>async def embedding_func(texts: list[str]) -&gt; np.ndarray:
    model = SentenceTransformer('all-MiniLM-L6-v2')
    embeddings = model.encode(texts, convert_to_numpy=True)
    return embeddings

# Initialize LightRAG with the LLM model function and embedding function
    rag = LightRAG(
        working_dir=WORKING_DIR,
        llm_model_func=llm_model_func,
        embedding_func=EmbeddingFunc(
            embedding_dim=384,
            max_token_size=8192,
            func=embedding_func,
        ),
        vector_storage="FaissVectorDBStorage",
        vector_db_storage_cls_kwargs={
            "cosine_better_than_threshold": 0.3  # Your desired threshold
        }
    )
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="async def embedding_func(texts: list[str]) -> np.ndarray:
    model = SentenceTransformer('all-MiniLM-L6-v2')
    embeddings = model.encode(texts, convert_to_numpy=True)
    return embeddings

# Initialize LightRAG with the LLM model function and embedding function
    rag = LightRAG(
        working_dir=WORKING_DIR,
        llm_model_func=llm_model_func,
        embedding_func=EmbeddingFunc(
            embedding_dim=384,
            max_token_size=8192,
            func=embedding_func,
        ),
        vector_storage=&quot;FaissVectorDBStorage&quot;,
        vector_db_storage_cls_kwargs={
            &quot;cosine_better_than_threshold&quot;: 0.3  # Your desired threshold
        }
    )" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="14321710" _msthash="386">插入自定义 KG</h3><a id="user-content-insert-custom-kg" class="anchor" aria-label="永久链接：插入自定义 KG" href="#insert-custom-kg" _mstaria-label="575263" _msthash="387"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
     <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
     <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">llm_model_func</span>,
     <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
          <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-s1">embedding_dimension</span>,
          <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
          <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-s1">embedding_func</span>,
     ),
)

<span class="pl-s1">custom_kg</span> <span class="pl-c1">=</span> {
    <span class="pl-s">"entities"</span>: [
        {
            <span class="pl-s">"entity_name"</span>: <span class="pl-s">"CompanyA"</span>,
            <span class="pl-s">"entity_type"</span>: <span class="pl-s">"Organization"</span>,
            <span class="pl-s">"description"</span>: <span class="pl-s">"A major technology company"</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"Source1"</span>
        },
        {
            <span class="pl-s">"entity_name"</span>: <span class="pl-s">"ProductX"</span>,
            <span class="pl-s">"entity_type"</span>: <span class="pl-s">"Product"</span>,
            <span class="pl-s">"description"</span>: <span class="pl-s">"A popular product developed by CompanyA"</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"Source1"</span>
        }
    ],
    <span class="pl-s">"relationships"</span>: [
        {
            <span class="pl-s">"src_id"</span>: <span class="pl-s">"CompanyA"</span>,
            <span class="pl-s">"tgt_id"</span>: <span class="pl-s">"ProductX"</span>,
            <span class="pl-s">"description"</span>: <span class="pl-s">"CompanyA develops ProductX"</span>,
            <span class="pl-s">"keywords"</span>: <span class="pl-s">"develop, produce"</span>,
            <span class="pl-s">"weight"</span>: <span class="pl-c1">1.0</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"Source1"</span>
        }
    ],
    <span class="pl-s">"chunks"</span>: [
        {
            <span class="pl-s">"content"</span>: <span class="pl-s">"ProductX, developed by CompanyA, has revolutionized the market with its cutting-edge features."</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"Source1"</span>,
        },
        {
            <span class="pl-s">"content"</span>: <span class="pl-s">"PersonA is a prominent researcher at UniversityB, focusing on artificial intelligence and machine learning."</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"Source2"</span>,
        },
        {
            <span class="pl-s">"content"</span>: <span class="pl-s">"None"</span>,
            <span class="pl-s">"source_id"</span>: <span class="pl-s">"UNKNOWN"</span>,
        },
    ],
}

<span class="pl-s1">rag</span>.<span class="pl-c1">insert_custom_kg</span>(<span class="pl-s1">custom_kg</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="rag = LightRAG(
     working_dir=WORKING_DIR,
     llm_model_func=llm_model_func,
     embedding_func=EmbeddingFunc(
          embedding_dim=embedding_dimension,
          max_token_size=8192,
          func=embedding_func,
     ),
)

custom_kg = {
    &quot;entities&quot;: [
        {
            &quot;entity_name&quot;: &quot;CompanyA&quot;,
            &quot;entity_type&quot;: &quot;Organization&quot;,
            &quot;description&quot;: &quot;A major technology company&quot;,
            &quot;source_id&quot;: &quot;Source1&quot;
        },
        {
            &quot;entity_name&quot;: &quot;ProductX&quot;,
            &quot;entity_type&quot;: &quot;Product&quot;,
            &quot;description&quot;: &quot;A popular product developed by CompanyA&quot;,
            &quot;source_id&quot;: &quot;Source1&quot;
        }
    ],
    &quot;relationships&quot;: [
        {
            &quot;src_id&quot;: &quot;CompanyA&quot;,
            &quot;tgt_id&quot;: &quot;ProductX&quot;,
            &quot;description&quot;: &quot;CompanyA develops ProductX&quot;,
            &quot;keywords&quot;: &quot;develop, produce&quot;,
            &quot;weight&quot;: 1.0,
            &quot;source_id&quot;: &quot;Source1&quot;
        }
    ],
    &quot;chunks&quot;: [
        {
            &quot;content&quot;: &quot;ProductX, developed by CompanyA, has revolutionized the market with its cutting-edge features.&quot;,
            &quot;source_id&quot;: &quot;Source1&quot;,
        },
        {
            &quot;content&quot;: &quot;PersonA is a prominent researcher at UniversityB, focusing on artificial intelligence and machine learning.&quot;,
            &quot;source_id&quot;: &quot;Source2&quot;,
        },
        {
            &quot;content&quot;: &quot;None&quot;,
            &quot;source_id&quot;: &quot;UNKNOWN&quot;,
        },
    ],
}

rag.insert_custom_kg(custom_kg)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="5917184" _msthash="388">删除</h3><a id="user-content-delete" class="anchor" aria-label="永久链接：删除" href="#delete" _mstaria-label="298857" _msthash="389"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">rag</span> <span class="pl-c1">=</span> <span class="pl-en">LightRAG</span>(
     <span class="pl-s1">working_dir</span><span class="pl-c1">=</span><span class="pl-c1">WORKING_DIR</span>,
     <span class="pl-s1">llm_model_func</span><span class="pl-c1">=</span><span class="pl-s1">llm_model_func</span>,
     <span class="pl-s1">embedding_func</span><span class="pl-c1">=</span><span class="pl-en">EmbeddingFunc</span>(
          <span class="pl-s1">embedding_dim</span><span class="pl-c1">=</span><span class="pl-s1">embedding_dimension</span>,
          <span class="pl-s1">max_token_size</span><span class="pl-c1">=</span><span class="pl-c1">8192</span>,
          <span class="pl-s1">func</span><span class="pl-c1">=</span><span class="pl-s1">embedding_func</span>,
     ),
)

<span class="pl-c">#  Delete Entity: Deleting entities by their names</span>
<span class="pl-s1">rag</span>.<span class="pl-c1">delete_by_entity</span>(<span class="pl-s">"Project Gutenberg"</span>)

<span class="pl-c">#  Delete Document: Deleting entities and relationships associated with the document by doc id</span>
<span class="pl-s1">rag</span>.<span class="pl-c1">delete_by_doc_id</span>(<span class="pl-s">"doc_id"</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="
rag = LightRAG(
     working_dir=WORKING_DIR,
     llm_model_func=llm_model_func,
     embedding_func=EmbeddingFunc(
          embedding_dim=embedding_dimension,
          max_token_size=8192,
          func=embedding_func,
     ),
)

#  Delete Entity: Deleting entities by their names
rag.delete_by_entity(&quot;Project Gutenberg&quot;)

#  Delete Document: Deleting entities and relationships associated with the document by doc id
rag.delete_by_doc_id(&quot;doc_id&quot;)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="22815468" _msthash="390">多文件类型支持</h3><a id="user-content-multi-file-type-support" class="anchor" aria-label="永久链接：多文件类型支持" href="#multi-file-type-support" _mstaria-label="916435" _msthash="391"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="93436707" _msthash="392">支持读取 TXT、DOCX、PPTX、CSV 和 PDF 等文件类型。</font><code>textract</code></p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-s1">textract</span>

<span class="pl-s1">file_path</span> <span class="pl-c1">=</span> <span class="pl-s">'TEXT.pdf'</span>
<span class="pl-s1">text_content</span> <span class="pl-c1">=</span> <span class="pl-s1">textract</span>.<span class="pl-c1">process</span>(<span class="pl-s1">file_path</span>)

<span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>(<span class="pl-s1">text_content</span>.<span class="pl-c1">decode</span>(<span class="pl-s">'utf-8'</span>))</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="import textract

file_path = 'TEXT.pdf'
text_content = textract.process(file_path)

rag.insert(text_content.decode('utf-8'))" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="14706731" _msthash="393">图形可视化</h3><a id="user-content-graph-visualization" class="anchor" aria-label="永久链接：图形可视化" href="#graph-visualization" _mstaria-label="779844" _msthash="394"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<details>
<summary _msttexthash="45281990" _msthash="395">使用 html 进行图形可视化</summary>
<ul dir="auto">
<li><font _mstmutation="1" _msttexthash="20266389" _msthash="396">以下代码可以在</font><code>examples/graph_visual_with_html.py</code></li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-s1">networkx</span> <span class="pl-k">as</span> <span class="pl-s1">nx</span>
<span class="pl-k">from</span> <span class="pl-s1">pyvis</span>.<span class="pl-s1">network</span> <span class="pl-k">import</span> <span class="pl-v">Network</span>

<span class="pl-c"># Load the GraphML file</span>
<span class="pl-c1">G</span> <span class="pl-c1">=</span> <span class="pl-s1">nx</span>.<span class="pl-c1">read_graphml</span>(<span class="pl-s">'./dickens/graph_chunk_entity_relation.graphml'</span>)

<span class="pl-c"># Create a Pyvis network</span>
<span class="pl-s1">net</span> <span class="pl-c1">=</span> <span class="pl-en">Network</span>(<span class="pl-s1">notebook</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)

<span class="pl-c"># Convert NetworkX graph to Pyvis network</span>
<span class="pl-s1">net</span>.<span class="pl-c1">from_nx</span>(<span class="pl-c1">G</span>)

<span class="pl-c"># Save and display the network</span>
<span class="pl-s1">net</span>.<span class="pl-c1">show</span>(<span class="pl-s">'knowledge_graph.html'</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="import networkx as nx
from pyvis.network import Network

# Load the GraphML file
G = nx.read_graphml('./dickens/graph_chunk_entity_relation.graphml')

# Create a Pyvis network
net = Network(notebook=True)

# Convert NetworkX graph to Pyvis network
net.from_nx(G)

# Save and display the network
net.show('knowledge_graph.html')" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary _msttexthash="47840104" _msthash="397">使用 Neo4j 进行图形可视化</summary>
<ul dir="auto">
<li><font _mstmutation="1" _msttexthash="20266389" _msthash="398">以下代码可以在</font><code>examples/graph_visual_with_neo4j.py</code></li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-s1">os</span>
<span class="pl-k">import</span> <span class="pl-s1">json</span>
<span class="pl-k">from</span> <span class="pl-s1">lightrag</span>.<span class="pl-s1">utils</span> <span class="pl-k">import</span> <span class="pl-s1">xml_to_json</span>
<span class="pl-k">from</span> <span class="pl-s1">neo4j</span> <span class="pl-k">import</span> <span class="pl-v">GraphDatabase</span>

<span class="pl-c"># Constants</span>
<span class="pl-c1">WORKING_DIR</span> <span class="pl-c1">=</span> <span class="pl-s">"./dickens"</span>
<span class="pl-c1">BATCH_SIZE_NODES</span> <span class="pl-c1">=</span> <span class="pl-c1">500</span>
<span class="pl-c1">BATCH_SIZE_EDGES</span> <span class="pl-c1">=</span> <span class="pl-c1">100</span>

<span class="pl-c"># Neo4j connection credentials</span>
<span class="pl-v">NEO4J_URI</span> <span class="pl-c1">=</span> <span class="pl-s">"bolt://localhost:7687"</span>
<span class="pl-v">NEO4J_USERNAME</span> <span class="pl-c1">=</span> <span class="pl-s">"neo4j"</span>
<span class="pl-v">NEO4J_PASSWORD</span> <span class="pl-c1">=</span> <span class="pl-s">"your_password"</span>

<span class="pl-k">def</span> <span class="pl-en">convert_xml_to_json</span>(<span class="pl-s1">xml_path</span>, <span class="pl-s1">output_path</span>):
    <span class="pl-s">"""Converts XML file to JSON and saves the output."""</span>
    <span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">exists</span>(<span class="pl-s1">xml_path</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"Error: File not found - <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">xml_path</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">return</span> <span class="pl-c1">None</span>

    <span class="pl-s1">json_data</span> <span class="pl-c1">=</span> <span class="pl-en">xml_to_json</span>(<span class="pl-s1">xml_path</span>)
    <span class="pl-k">if</span> <span class="pl-s1">json_data</span>:
        <span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s1">output_path</span>, <span class="pl-s">'w'</span>, <span class="pl-s1">encoding</span><span class="pl-c1">=</span><span class="pl-s">'utf-8'</span>) <span class="pl-k">as</span> <span class="pl-s1">f</span>:
            <span class="pl-s1">json</span>.<span class="pl-c1">dump</span>(<span class="pl-s1">json_data</span>, <span class="pl-s1">f</span>, <span class="pl-s1">ensure_ascii</span><span class="pl-c1">=</span><span class="pl-c1">False</span>, <span class="pl-s1">indent</span><span class="pl-c1">=</span><span class="pl-c1">2</span>)
        <span class="pl-en">print</span>(<span class="pl-s">f"JSON file created: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">output_path</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">return</span> <span class="pl-s1">json_data</span>
    <span class="pl-k">else</span>:
        <span class="pl-en">print</span>(<span class="pl-s">"Failed to create JSON data"</span>)
        <span class="pl-k">return</span> <span class="pl-c1">None</span>

<span class="pl-k">def</span> <span class="pl-en">process_in_batches</span>(<span class="pl-s1">tx</span>, <span class="pl-s1">query</span>, <span class="pl-s1">data</span>, <span class="pl-s1">batch_size</span>):
    <span class="pl-s">"""Process data in batches and execute the given query."""</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">0</span>, <span class="pl-en">len</span>(<span class="pl-s1">data</span>), <span class="pl-s1">batch_size</span>):
        <span class="pl-s1">batch</span> <span class="pl-c1">=</span> <span class="pl-s1">data</span>[<span class="pl-s1">i</span>:<span class="pl-s1">i</span> <span class="pl-c1">+</span> <span class="pl-s1">batch_size</span>]
        <span class="pl-s1">tx</span>.<span class="pl-c1">run</span>(<span class="pl-s1">query</span>, {<span class="pl-s">"nodes"</span>: <span class="pl-s1">batch</span>} <span class="pl-k">if</span> <span class="pl-s">"nodes"</span> <span class="pl-c1">in</span> <span class="pl-s1">query</span> <span class="pl-k">else</span> {<span class="pl-s">"edges"</span>: <span class="pl-s1">batch</span>})

<span class="pl-k">def</span> <span class="pl-en">main</span>():
    <span class="pl-c"># Paths</span>
    <span class="pl-s1">xml_file</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">join</span>(<span class="pl-c1">WORKING_DIR</span>, <span class="pl-s">'graph_chunk_entity_relation.graphml'</span>)
    <span class="pl-s1">json_file</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">join</span>(<span class="pl-c1">WORKING_DIR</span>, <span class="pl-s">'graph_data.json'</span>)

    <span class="pl-c"># Convert XML to JSON</span>
    <span class="pl-s1">json_data</span> <span class="pl-c1">=</span> <span class="pl-en">convert_xml_to_json</span>(<span class="pl-s1">xml_file</span>, <span class="pl-s1">json_file</span>)
    <span class="pl-k">if</span> <span class="pl-s1">json_data</span> <span class="pl-c1">is</span> <span class="pl-c1">None</span>:
        <span class="pl-k">return</span>

    <span class="pl-c"># Load nodes and edges</span>
    <span class="pl-s1">nodes</span> <span class="pl-c1">=</span> <span class="pl-s1">json_data</span>.<span class="pl-c1">get</span>(<span class="pl-s">'nodes'</span>, [])
    <span class="pl-s1">edges</span> <span class="pl-c1">=</span> <span class="pl-s1">json_data</span>.<span class="pl-c1">get</span>(<span class="pl-s">'edges'</span>, [])

    <span class="pl-c"># Neo4j queries</span>
    <span class="pl-s1">create_nodes_query</span> <span class="pl-c1">=</span> <span class="pl-s">"""</span>
<span class="pl-s">    UNWIND $nodes AS node</span>
<span class="pl-s">    MERGE (e:Entity {id: node.id})</span>
<span class="pl-s">    SET e.entity_type = node.entity_type,</span>
<span class="pl-s">        e.description = node.description,</span>
<span class="pl-s">        e.source_id = node.source_id,</span>
<span class="pl-s">        e.displayName = node.id</span>
<span class="pl-s">    REMOVE e:Entity</span>
<span class="pl-s">    WITH e, node</span>
<span class="pl-s">    CALL apoc.create.addLabels(e, [node.entity_type]) YIELD node AS labeledNode</span>
<span class="pl-s">    RETURN count(*)</span>
<span class="pl-s">    """</span>

    <span class="pl-s1">create_edges_query</span> <span class="pl-c1">=</span> <span class="pl-s">"""</span>
<span class="pl-s">    UNWIND $edges AS edge</span>
<span class="pl-s">    MATCH (source {id: edge.source})</span>
<span class="pl-s">    MATCH (target {id: edge.target})</span>
<span class="pl-s">    WITH source, target, edge,</span>
<span class="pl-s">         CASE</span>
<span class="pl-s">            WHEN edge.keywords CONTAINS 'lead' THEN 'lead'</span>
<span class="pl-s">            WHEN edge.keywords CONTAINS 'participate' THEN 'participate'</span>
<span class="pl-s">            WHEN edge.keywords CONTAINS 'uses' THEN 'uses'</span>
<span class="pl-s">            WHEN edge.keywords CONTAINS 'located' THEN 'located'</span>
<span class="pl-s">            WHEN edge.keywords CONTAINS 'occurs' THEN 'occurs'</span>
<span class="pl-s">           ELSE REPLACE(SPLIT(edge.keywords, ',')[0], '<span class="pl-cce">\"</span>', '')</span>
<span class="pl-s">         END AS relType</span>
<span class="pl-s">    CALL apoc.create.relationship(source, relType, {</span>
<span class="pl-s">      weight: edge.weight,</span>
<span class="pl-s">      description: edge.description,</span>
<span class="pl-s">      keywords: edge.keywords,</span>
<span class="pl-s">      source_id: edge.source_id</span>
<span class="pl-s">    }, target) YIELD rel</span>
<span class="pl-s">    RETURN count(*)</span>
<span class="pl-s">    """</span>

    <span class="pl-s1">set_displayname_and_labels_query</span> <span class="pl-c1">=</span> <span class="pl-s">"""</span>
<span class="pl-s">    MATCH (n)</span>
<span class="pl-s">    SET n.displayName = n.id</span>
<span class="pl-s">    WITH n</span>
<span class="pl-s">    CALL apoc.create.setLabels(n, [n.entity_type]) YIELD node</span>
<span class="pl-s">    RETURN count(*)</span>
<span class="pl-s">    """</span>

    <span class="pl-c"># Create a Neo4j driver</span>
    <span class="pl-s1">driver</span> <span class="pl-c1">=</span> <span class="pl-v">GraphDatabase</span>.<span class="pl-c1">driver</span>(<span class="pl-v">NEO4J_URI</span>, <span class="pl-s1">auth</span><span class="pl-c1">=</span>(<span class="pl-v">NEO4J_USERNAME</span>, <span class="pl-v">NEO4J_PASSWORD</span>))

    <span class="pl-k">try</span>:
        <span class="pl-c"># Execute queries in batches</span>
        <span class="pl-k">with</span> <span class="pl-s1">driver</span>.<span class="pl-c1">session</span>() <span class="pl-k">as</span> <span class="pl-s1">session</span>:
            <span class="pl-c"># Insert nodes in batches</span>
            <span class="pl-s1">session</span>.<span class="pl-c1">execute_write</span>(<span class="pl-s1">process_in_batches</span>, <span class="pl-s1">create_nodes_query</span>, <span class="pl-s1">nodes</span>, <span class="pl-c1">BATCH_SIZE_NODES</span>)

            <span class="pl-c"># Insert edges in batches</span>
            <span class="pl-s1">session</span>.<span class="pl-c1">execute_write</span>(<span class="pl-s1">process_in_batches</span>, <span class="pl-s1">create_edges_query</span>, <span class="pl-s1">edges</span>, <span class="pl-c1">BATCH_SIZE_EDGES</span>)

            <span class="pl-c"># Set displayName and labels</span>
            <span class="pl-s1">session</span>.<span class="pl-c1">run</span>(<span class="pl-s1">set_displayname_and_labels_query</span>)

    <span class="pl-k">except</span> <span class="pl-v">Exception</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
        <span class="pl-en">print</span>(<span class="pl-s">f"Error occurred: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)

    <span class="pl-k">finally</span>:
        <span class="pl-s1">driver</span>.<span class="pl-c1">close</span>()

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-en">main</span>()</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="import os
import json
from lightrag.utils import xml_to_json
from neo4j import GraphDatabase

# Constants
WORKING_DIR = &quot;./dickens&quot;
BATCH_SIZE_NODES = 500
BATCH_SIZE_EDGES = 100

# Neo4j connection credentials
NEO4J_URI = &quot;bolt://localhost:7687&quot;
NEO4J_USERNAME = &quot;neo4j&quot;
NEO4J_PASSWORD = &quot;your_password&quot;

def convert_xml_to_json(xml_path, output_path):
    &quot;&quot;&quot;Converts XML file to JSON and saves the output.&quot;&quot;&quot;
    if not os.path.exists(xml_path):
        print(f&quot;Error: File not found - {xml_path}&quot;)
        return None

    json_data = xml_to_json(xml_path)
    if json_data:
        with open(output_path, 'w', encoding='utf-8') as f:
            json.dump(json_data, f, ensure_ascii=False, indent=2)
        print(f&quot;JSON file created: {output_path}&quot;)
        return json_data
    else:
        print(&quot;Failed to create JSON data&quot;)
        return None

def process_in_batches(tx, query, data, batch_size):
    &quot;&quot;&quot;Process data in batches and execute the given query.&quot;&quot;&quot;
    for i in range(0, len(data), batch_size):
        batch = data[i:i + batch_size]
        tx.run(query, {&quot;nodes&quot;: batch} if &quot;nodes&quot; in query else {&quot;edges&quot;: batch})

def main():
    # Paths
    xml_file = os.path.join(WORKING_DIR, 'graph_chunk_entity_relation.graphml')
    json_file = os.path.join(WORKING_DIR, 'graph_data.json')

    # Convert XML to JSON
    json_data = convert_xml_to_json(xml_file, json_file)
    if json_data is None:
        return

    # Load nodes and edges
    nodes = json_data.get('nodes', [])
    edges = json_data.get('edges', [])

    # Neo4j queries
    create_nodes_query = &quot;&quot;&quot;
    UNWIND $nodes AS node
    MERGE (e:Entity {id: node.id})
    SET e.entity_type = node.entity_type,
        e.description = node.description,
        e.source_id = node.source_id,
        e.displayName = node.id
    REMOVE e:Entity
    WITH e, node
    CALL apoc.create.addLabels(e, [node.entity_type]) YIELD node AS labeledNode
    RETURN count(*)
    &quot;&quot;&quot;

    create_edges_query = &quot;&quot;&quot;
    UNWIND $edges AS edge
    MATCH (source {id: edge.source})
    MATCH (target {id: edge.target})
    WITH source, target, edge,
         CASE
            WHEN edge.keywords CONTAINS 'lead' THEN 'lead'
            WHEN edge.keywords CONTAINS 'participate' THEN 'participate'
            WHEN edge.keywords CONTAINS 'uses' THEN 'uses'
            WHEN edge.keywords CONTAINS 'located' THEN 'located'
            WHEN edge.keywords CONTAINS 'occurs' THEN 'occurs'
           ELSE REPLACE(SPLIT(edge.keywords, ',')[0], '\&quot;', '')
         END AS relType
    CALL apoc.create.relationship(source, relType, {
      weight: edge.weight,
      description: edge.description,
      keywords: edge.keywords,
      source_id: edge.source_id
    }, target) YIELD rel
    RETURN count(*)
    &quot;&quot;&quot;

    set_displayname_and_labels_query = &quot;&quot;&quot;
    MATCH (n)
    SET n.displayName = n.id
    WITH n
    CALL apoc.create.setLabels(n, [n.entity_type]) YIELD node
    RETURN count(*)
    &quot;&quot;&quot;

    # Create a Neo4j driver
    driver = GraphDatabase.driver(NEO4J_URI, auth=(NEO4J_USERNAME, NEO4J_PASSWORD))

    try:
        # Execute queries in batches
        with driver.session() as session:
            # Insert nodes in batches
            session.execute_write(process_in_batches, create_nodes_query, nodes, BATCH_SIZE_NODES)

            # Insert edges in batches
            session.execute_write(process_in_batches, create_edges_query, edges, BATCH_SIZE_EDGES)

            # Set displayName and labels
            session.run(set_displayname_and_labels_query)

    except Exception as e:
        print(f&quot;Error occurred: {e}&quot;)

    finally:
        driver.close()

if __name__ == &quot;__main__&quot;:
    main()" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="25109279" _msthash="399">LightRAG 初始化参数</h3><a id="user-content-lightrag-init-parameters" class="anchor" aria-label="永久链接：LightRAG 初始化参数" href="#lightrag-init-parameters" _mstaria-label="957086" _msthash="400"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<markdown-accessiblity-table data-catalyst=""><table tabindex="0">
<thead>
<tr>
<th><strong _msttexthash="4651894" _msthash="401">参数</strong></th>
<th><strong _msttexthash="5230641" _msthash="402">类型</strong></th>
<th><strong _msttexthash="7093697" _msthash="403">解释</strong></th>
<th><strong _msttexthash="6723327" _msthash="404">违约</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong _msttexthash="183027" _msthash="405">working_dir</strong></td>
<td><code>str</code></td>
<td _msttexthash="28461251" _msthash="406">缓存将存储的目录</td>
<td><code>lightrag_cache+timestamp</code></td>
</tr>
<tr>
<td><strong _msttexthash="159991" _msthash="407">kv_storage</strong></td>
<td><code>str</code></td>
<td><font _mstmutation="1" _msttexthash="124867990" _msthash="408">文档和文本块的存储类型。支持的类型： ，</font><code>JsonKVStorage</code><code>OracleKVStorage</code></td>
<td><code>JsonKVStorage</code></td>
</tr>
<tr>
<td><strong _msttexthash="263848" _msthash="409">vector_storage</strong></td>
<td><code>str</code></td>
<td><font _mstmutation="1" _msttexthash="107665974" _msthash="410">嵌入向量的存储类型。支持的类型： ，</font><code>NanoVectorDBStorage</code><code>OracleVectorDBStorage</code></td>
<td><code>NanoVectorDBStorage</code></td>
</tr>
<tr>
<td><strong _msttexthash="233220" _msthash="411">graph_storage</strong></td>
<td><code>str</code></td>
<td><font _mstmutation="1" _msttexthash="124526584" _msthash="412">图形边缘和节点的存储类型。支持的类型：、 、</font><code>NetworkXStorage</code><code>Neo4JStorage</code><code>OracleGraphStorage</code></td>
<td><code>NetworkXStorage</code></td>
</tr>
<tr>
<td><strong _msttexthash="136357" _msthash="413">log_level</strong></td>
<td></td>
<td _msttexthash="55043287" _msthash="414">应用程序运行时的日志级别</td>
<td><code>logging.DEBUG</code></td>
</tr>
<tr>
<td><strong _msttexthash="324051" _msthash="415">chunk_token_size</strong></td>
<td><code>int</code></td>
<td _msttexthash="67254395" _msthash="416">拆分文档时每个块的最大令牌大小</td>
<td><code>1200</code></td>
</tr>
<tr>
<td><strong _msttexthash="619255" _msthash="417">chunk_overlap_token_size</strong></td>
<td><code>int</code></td>
<td _msttexthash="99478938" _msthash="418">拆分文档时，两个块之间的令牌大小重叠</td>
<td><code>100</code></td>
</tr>
<tr>
<td><strong _msttexthash="414115" _msthash="419">tiktoken_model_name</strong></td>
<td><code>str</code></td>
<td _msttexthash="118141296" _msthash="420">用于计算 Token 编号的 Tiktoken 编码器的模型名称</td>
<td><code>gpt-4o-mini</code></td>
</tr>
<tr>
<td><strong _msttexthash="743431" _msthash="421">entity_extract_max_gleaning</strong></td>
<td><code>int</code></td>
<td _msttexthash="123768346" _msthash="422">实体提取过程中的循环数，附加历史记录消息</td>
<td><code>1</code></td>
</tr>
<tr>
<td><strong _msttexthash="809224" _msthash="423">entity_summary_to_max_tokens</strong></td>
<td><code>int</code></td>
<td _msttexthash="55347097" _msthash="424">每个实体摘要的最大令牌大小</td>
<td><code>500</code></td>
</tr>
<tr>
<td><strong _msttexthash="606606" _msthash="425">node_embedding_algorithm</strong></td>
<td><code>str</code></td>
<td _msttexthash="73134204" _msthash="426">节点嵌入算法（当前未使用）</td>
<td><code>node2vec</code></td>
</tr>
<tr>
<td><strong _msttexthash="280657" _msthash="427">node2vec_params</strong></td>
<td><code>dict</code></td>
<td _msttexthash="23616840" _msthash="428">节点嵌入的参数</td>
<td><code>{"dimensions": 1536,"num_walks": 10,"walk_length": 40,"window_size": 2,"iterations": 3,"random_seed": 3,}</code></td>
</tr>
<tr>
<td><strong _msttexthash="255463" _msthash="429">embedding_func</strong></td>
<td><code>EmbeddingFunc</code></td>
<td _msttexthash="50585509" _msthash="430">从文本生成嵌入向量的函数</td>
<td><code>openai_embed</code></td>
</tr>
<tr>
<td><strong _msttexthash="411762" _msthash="431">embedding_batch_num</strong></td>
<td><code>int</code></td>
<td _msttexthash="155578033" _msthash="432">嵌入进程的最大批量大小（每批次发送多个文本）</td>
<td><code>32</code></td>
</tr>
<tr>
<td><strong _msttexthash="607165" _msthash="433">embedding_func_max_async</strong></td>
<td><code>int</code></td>
<td _msttexthash="45406205" _msthash="434">最大并发异步嵌入进程数</td>
<td><code>16</code></td>
</tr>
<tr>
<td><strong _msttexthash="257998" _msthash="435">llm_model_func</strong></td>
<td><code>callable</code></td>
<td _msttexthash="15174367" _msthash="436">LLM 生成函数</td>
<td><code>gpt_4o_mini_complete</code></td>
</tr>
<tr>
<td><strong _msttexthash="255359" _msthash="437">llm_model_name</strong></td>
<td><code>str</code></td>
<td _msttexthash="28280915" _msthash="438">生成的 LLM 模型名称</td>
<td><code>meta-llama/Llama-3.2-1B-Instruct</code></td>
</tr>
<tr>
<td><strong _msttexthash="615043" _msthash="439">llm_model_max_token_size</strong></td>
<td><code>int</code></td>
<td _msttexthash="144329458" _msthash="440">LLM 生成的最大令牌大小（影响实体关系摘要）</td>
<td><code>32768</code><font _mstmutation="1" _msttexthash="66494675" _msthash="441">（默认值由 env var MAX_TOKENS 更改）</font></td>
</tr>
<tr>
<td><strong _msttexthash="418340" _msthash="442">llm_model_max_async</strong></td>
<td><code>int</code></td>
<td _msttexthash="57280236" _msthash="443">并发异步 LLM 进程的最大数量</td>
<td><code>16</code><font _mstmutation="1" _msttexthash="64936625" _msthash="444">（默认值由 env var MAX_ASYNC 更改）</font></td>
</tr>
<tr>
<td><strong _msttexthash="321269" _msthash="445">llm_model_kwargs</strong></td>
<td><code>dict</code></td>
<td _msttexthash="32177821" _msthash="446">LLM 生成的附加参数</td>
<td></td>
</tr>
<tr>
<td><strong _msttexthash="791986" _msthash="447">vector_db_storage_cls_kwargs</strong></td>
<td><code>dict</code></td>
<td _msttexthash="184466217" _msthash="448">矢量数据库的其他参数，例如设置节点和关系检索的阈值。</td>
<td _msttexthash="236077400" _msthash="449">cosine_better_than_threshold：0.2（默认值由 env var COSINE_THRESHOLD 更改）</td>
</tr>
<tr>
<td><strong _msttexthash="306501" _msthash="450">enable_llm_cache</strong></td>
<td><code>bool</code></td>
<td><font _mstmutation="1" _msttexthash="149231563" _msthash="451">如果 ，将 LLM 存储在缓存中;重复提示返回缓存的响应</font><code>TRUE</code></td>
<td><code>TRUE</code></td>
</tr>
<tr>
<td><strong _msttexthash="1159340" _msthash="452">enable_llm_cache_for_entity_extract</strong></td>
<td><code>bool</code></td>
<td><font _mstmutation="1" _msttexthash="249872610" _msthash="453">如果 ，则存储 LLM 会导致缓存以进行实体提取;适合初学者调试应用程序</font><code>TRUE</code></td>
<td><code>TRUE</code></td>
</tr>
<tr>
<td><strong _msttexthash="205894" _msthash="454">addon_params</strong></td>
<td><code>dict</code></td>
<td><font _mstmutation="1" _msttexthash="234858845" _msthash="455">其他参数，例如 ：设置文档处理的示例限制、输出语言和批处理大小</font><code>{"example_number": 1, "language": "Simplified Chinese", "entity_types": ["organization", "person", "geo", "event"], "insert_batch_size": 10}</code></td>
<td><code>example_number: all examples, language: English, insert_batch_size: 10</code></td>
</tr>
<tr>
<td><strong _msttexthash="850213" _msthash="456">convert_response_to_json_func</strong></td>
<td><code>callable</code></td>
<td _msttexthash="8028878" _msthash="457">未使用</td>
<td><code>convert_response_to_json</code></td>
</tr>
<tr>
<td><strong _msttexthash="512252" _msthash="458">embedding_cache_config</strong></td>
<td><code>dict</code></td>
<td><font _mstmutation="1" _msttexthash="5648537778" _msthash="459">问答缓存的配置。包含三个参数：<br _mstmutation="1" _istranslated="1">-：用于启用/禁用缓存查找功能的布尔值。启用后，系统将在生成新答案之前检查缓存的响应。<br _mstmutation="1" _istranslated="1">- ： 浮点值 （0-1），相似度阈值。当新问题与缓存问题的相似度超过此阈值时，将直接返回缓存的答案，而无需调用 LLM。<br _mstmutation="1" _istranslated="1">- ： 用于启用/禁用 LLM 相似性验证的布尔值。启用后，LLM 将用作辅助检查，以在返回缓存的答案之前验证问题之间的相似性。</font><code>enabled</code><code>similarity_threshold</code><code>use_llm_check</code></td>
<td><font _mstmutation="1" _msttexthash="14364129" _msthash="460">违约：</font><code>{"enabled": False, "similarity_threshold": 0.95, "use_llm_check": False}</code></td>
</tr>
<tr>
<td><strong _msttexthash="95719" _msthash="461">log_dir</strong></td>
<td><code>str</code></td>
<td _msttexthash="31821244" _msthash="462">Directory 来存储日志。</td>
<td><code>./</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="13726427" _msthash="463">错误处理</h3><a id="user-content-error-handling" class="anchor" aria-label="永久链接： 错误处理" href="#error-handling" _mstaria-label="545415" _msthash="464"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<details>
<summary _msttexthash="61905623" _msthash="465">单击可查看错误处理详细信息</summary>
<p dir="auto" _msttexthash="1494792" _msthash="466">The API includes comprehensive error handling:</p>
<ul dir="auto">
<li _msttexthash="477191" _msthash="467">File not found errors (404)</li>
<li _msttexthash="403533" _msthash="468">Processing errors (500)</li>
<li _msttexthash="1363128" _msthash="469">Supports multiple file encodings (UTF-8 and GBK)</li>
</ul>
</details>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="159042" _msthash="470">Evaluation</h2><a id="user-content-evaluation" class="anchor" aria-label="Permalink: Evaluation" href="#evaluation" _mstaria-label="441987" _msthash="471"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="94263" _msthash="472">Dataset</h3><a id="user-content-dataset" class="anchor" aria-label="Permalink: Dataset" href="#dataset" _mstaria-label="333268" _msthash="473"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="3373682" _msthash="474">The dataset used in LightRAG can be downloaded from <a href="https://huggingface.co/datasets/TommyChien/UltraDomain" rel="nofollow">TommyChien/UltraDomain</a>.</p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="13106418" _msthash="475">生成查询</h3><a id="user-content-generate-query" class="anchor" aria-label="永久链接：生成查询" href="#generate-query" _mstaria-label="552955" _msthash="476"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="185404726" _msthash="477">LightRAG 使用以下提示生成高级查询，相应的代码位于 .</font><code>example/generate_query.py</code></p>
<details>
<summary _msttexthash="5552768" _msthash="478">提示</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-v">Given</span> <span class="pl-s1">the</span> <span class="pl-s1">following</span> <span class="pl-s1">description</span> <span class="pl-s1">of</span> <span class="pl-s1">a</span> <span class="pl-s1">dataset</span>:

{<span class="pl-s1">description</span>}

<span class="pl-v">Please</span> <span class="pl-s1">identify</span> <span class="pl-c1">5</span> <span class="pl-s1">potential</span> <span class="pl-s1">users</span> <span class="pl-s1">who</span> <span class="pl-s1">would</span> <span class="pl-s1">engage</span> <span class="pl-k">with</span> <span class="pl-s1">this</span> <span class="pl-s1">dataset</span>. <span class="pl-c1">For</span> <span class="pl-s1">each</span> <span class="pl-s1">user</span>, <span class="pl-s1">list</span> <span class="pl-c1">5</span> <span class="pl-s1">tasks</span> <span class="pl-s1">they</span> <span class="pl-s1">would</span> <span class="pl-s1">perform</span> <span class="pl-k">with</span> <span class="pl-s1">this</span> <span class="pl-s1">dataset</span>. <span class="pl-c1">Then</span>, <span class="pl-s1">for</span> <span class="pl-en">each</span> (<span class="pl-s1">user</span>, <span class="pl-s1">task</span>) <span class="pl-s1">combination</span>, <span class="pl-s1">generate</span> <span class="pl-c1">5</span> <span class="pl-s1">questions</span> <span class="pl-s1">that</span> <span class="pl-s1">require</span> <span class="pl-s1">a</span> <span class="pl-s1">high</span><span class="pl-c1">-</span><span class="pl-s1">level</span> <span class="pl-s1">understanding</span> <span class="pl-s1">of</span> <span class="pl-s1">the</span> <span class="pl-s1">entire</span> <span class="pl-s1">dataset</span>.

<span class="pl-c1">Output</span> <span class="pl-s1">the</span> <span class="pl-s1">results</span> <span class="pl-c1">in</span> <span class="pl-s1">the</span> <span class="pl-s1">following</span> <span class="pl-s1">structure</span>:
<span class="pl-c1">-</span> <span class="pl-v">User</span> <span class="pl-c1">1</span>: [<span class="pl-s1">user</span> <span class="pl-s1">description</span>]
    <span class="pl-c1">-</span> <span class="pl-v">Task</span> <span class="pl-c1">1</span>: [<span class="pl-s1">task</span> <span class="pl-s1">description</span>]
        <span class="pl-c1">-</span> <span class="pl-v">Question</span> <span class="pl-c1">1</span>:
        <span class="pl-c1">-</span> <span class="pl-v">Question</span> <span class="pl-c1">2</span>:
        <span class="pl-c1">-</span> <span class="pl-v">Question</span> <span class="pl-c1">3</span>:
        <span class="pl-c1">-</span> <span class="pl-v">Question</span> <span class="pl-c1">4</span>:
        <span class="pl-c1">-</span> <span class="pl-v">Question</span> <span class="pl-c1">5</span>:
    <span class="pl-c1">-</span> <span class="pl-v">Task</span> <span class="pl-c1">2</span>: [<span class="pl-s1">task</span> <span class="pl-s1">description</span>]
        ...
    <span class="pl-c1">-</span> <span class="pl-v">Task</span> <span class="pl-c1">5</span>: [<span class="pl-s1">task</span> <span class="pl-s1">description</span>]
<span class="pl-c1">-</span> <span class="pl-v">User</span> <span class="pl-c1">2</span>: [<span class="pl-s1">user</span> <span class="pl-s1">description</span>]
    ...
<span class="pl-c1">-</span> <span class="pl-v">User</span> <span class="pl-c1">5</span>: [<span class="pl-s1">user</span> <span class="pl-s1">description</span>]
    ...</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="Given the following description of a dataset:

{description}

Please identify 5 potential users who would engage with this dataset. For each user, list 5 tasks they would perform with this dataset. Then, for each (user, task) combination, generate 5 questions that require a high-level understanding of the entire dataset.

Output the results in the following structure:
- User 1: [user description]
    - Task 1: [task description]
        - Question 1:
        - Question 2:
        - Question 3:
        - Question 4:
        - Question 5:
    - Task 2: [task description]
        ...
    - Task 5: [task description]
- User 2: [user description]
    ...
- User 5: [user description]
    ..." tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="12997647" _msthash="479">批量评估</h3><a id="user-content-batch-eval" class="anchor" aria-label="永久链接：Batch Eval" href="#batch-eval" _mstaria-label="387153" _msthash="480"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="370785207" _msthash="481">为了评估两个 RAG 系统在高级查询上的性能，LightRAG 使用以下提示，具体代码可在 中找到。</font><code>example/batch_eval.py</code></p>
<details>
<summary _msttexthash="5552768" _msthash="482">提示</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-v">Role</span><span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-c1">-</span>
<span class="pl-v">You</span> <span class="pl-s1">are</span> <span class="pl-s1">an</span> <span class="pl-s1">expert</span> <span class="pl-s1">tasked</span> <span class="pl-k">with</span> <span class="pl-s1">evaluating</span> <span class="pl-s1">two</span> <span class="pl-s1">answers</span> <span class="pl-s1">to</span> <span class="pl-s1">the</span> <span class="pl-s1">same</span> <span class="pl-s1">question</span> <span class="pl-s1">based</span> <span class="pl-s1">on</span> <span class="pl-s1">three</span> <span class="pl-s1">criteria</span>: <span class="pl-c1">**</span><span class="pl-v">Comprehensiveness</span><span class="pl-c1">**</span>, <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-v">Diversity</span><span class="pl-c1">**</span>, <span class="pl-s1">and</span> <span class="pl-c1">**</span><span class="pl-v">Empowerment</span><span class="pl-c1">**</span>.
<span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-v">Goal</span><span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-c1">-</span>
<span class="pl-v">You</span> <span class="pl-s1">will</span> <span class="pl-s1">evaluate</span> <span class="pl-s1">two</span> <span class="pl-s1">answers</span> <span class="pl-s1">to</span> <span class="pl-s1">the</span> <span class="pl-s1">same</span> <span class="pl-s1">question</span> <span class="pl-s1">based</span> <span class="pl-s1">on</span> <span class="pl-s1">three</span> <span class="pl-s1">criteria</span>: <span class="pl-c1">**</span><span class="pl-v">Comprehensiveness</span><span class="pl-c1">**</span>, <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-v">Diversity</span><span class="pl-c1">**</span>, <span class="pl-s1">and</span> <span class="pl-c1">**</span><span class="pl-v">Empowerment</span><span class="pl-c1">**</span>.

<span class="pl-c1">-</span> <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-v">Comprehensiveness</span><span class="pl-c1">**</span>: <span class="pl-v">How</span> <span class="pl-s1">much</span> <span class="pl-s1">detail</span> <span class="pl-s1">does</span> <span class="pl-s1">the</span> <span class="pl-s1">answer</span> <span class="pl-s1">provide</span> <span class="pl-s1">to</span> <span class="pl-s1">cover</span> <span class="pl-s1">all</span> <span class="pl-s1">aspects</span> <span class="pl-c1">and</span> <span class="pl-s1">details</span> <span class="pl-s1">of</span> <span class="pl-s1">the</span> <span class="pl-s1">question</span>?
<span class="pl-c1">-</span> <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-v">Diversity</span><span class="pl-c1">**</span>: <span class="pl-v">How</span> <span class="pl-s1">varied</span> <span class="pl-c1">and</span> <span class="pl-s1">rich</span> <span class="pl-c1">is</span> <span class="pl-s1">the</span> <span class="pl-s1">answer</span> <span class="pl-c1">in</span> <span class="pl-s1">providing</span> <span class="pl-s1">different</span> <span class="pl-s1">perspectives</span> <span class="pl-c1">and</span> <span class="pl-s1">insights</span> <span class="pl-s1">on</span> <span class="pl-s1">the</span> <span class="pl-s1">question</span>?
<span class="pl-c1">-</span> <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-v">Empowerment</span><span class="pl-c1">**</span>: <span class="pl-v">How</span> <span class="pl-s1">well</span> <span class="pl-s1">does</span> <span class="pl-s1">the</span> <span class="pl-s1">answer</span> <span class="pl-s1">help</span> <span class="pl-s1">the</span> <span class="pl-s1">reader</span> <span class="pl-s1">understand</span> <span class="pl-c1">and</span> <span class="pl-s1">make</span> <span class="pl-s1">informed</span> <span class="pl-s1">judgments</span> <span class="pl-s1">about</span> <span class="pl-s1">the</span> <span class="pl-s1">topic</span>?

<span class="pl-v">For</span> <span class="pl-s1">each</span> <span class="pl-s1">criterion</span>, <span class="pl-s1">choose</span> <span class="pl-s1">the</span> <span class="pl-s1">better</span> <span class="pl-en">answer</span> (<span class="pl-s1">either</span> <span class="pl-v">Answer</span> <span class="pl-c1">1</span> <span class="pl-c1">or</span> <span class="pl-v">Answer</span> <span class="pl-c1">2</span>) <span class="pl-c1">and</span> <span class="pl-s1">explain</span> <span class="pl-s1">why</span>. <span class="pl-c1">Then</span>, <span class="pl-s1">select</span> <span class="pl-s1">an</span> <span class="pl-s1">overall</span> <span class="pl-s1">winner</span> <span class="pl-s1">based</span> <span class="pl-s1">on</span> <span class="pl-s1">these</span> <span class="pl-s1">three</span> <span class="pl-s1">categories</span>.

<span class="pl-v">Here</span> <span class="pl-c1">is</span> <span class="pl-s1">the</span> <span class="pl-s1">question</span>:
{<span class="pl-s1">query</span>}

<span class="pl-v">Here</span> <span class="pl-s1">are</span> <span class="pl-s1">the</span> <span class="pl-s1">two</span> <span class="pl-s1">answers</span>:

<span class="pl-c1">**</span><span class="pl-v">Answer</span> <span class="pl-c1">1</span>:<span class="pl-c1">**</span>
{<span class="pl-s1">answer1</span>}

<span class="pl-c1">**</span><span class="pl-v">Answer</span> <span class="pl-c1">2</span>:<span class="pl-c1">**</span>
{<span class="pl-s1">answer2</span>}

<span class="pl-v">Evaluate</span> <span class="pl-s1">both</span> <span class="pl-s1">answers</span> <span class="pl-s1">using</span> <span class="pl-s1">the</span> <span class="pl-s1">three</span> <span class="pl-s1">criteria</span> <span class="pl-s1">listed</span> <span class="pl-s1">above</span> <span class="pl-c1">and</span> <span class="pl-s1">provide</span> <span class="pl-s1">detailed</span> <span class="pl-s1">explanations</span> <span class="pl-s1">for</span> <span class="pl-s1">each</span> <span class="pl-s1">criterion</span>.

<span class="pl-c1">Output</span> <span class="pl-s1">your</span> <span class="pl-s1">evaluation</span> <span class="pl-c1">in</span> <span class="pl-s1">the</span> <span class="pl-s1">following</span> <span class="pl-c1">JSON</span> <span class="pl-s1">format</span>:

{{
    <span class="pl-s">"Comprehensiveness"</span>: {{
        <span class="pl-s">"Winner"</span>: <span class="pl-s">"[Answer 1 or Answer 2]"</span>,
        <span class="pl-s">"Explanation"</span>: <span class="pl-s">"[Provide explanation here]"</span>
    }},
    <span class="pl-s">"Empowerment"</span>: {{
        <span class="pl-s">"Winner"</span>: <span class="pl-s">"[Answer 1 or Answer 2]"</span>,
        <span class="pl-s">"Explanation"</span>: <span class="pl-s">"[Provide explanation here]"</span>
    }},
    <span class="pl-s">"Overall Winner"</span>: {{
        <span class="pl-s">"Winner"</span>: <span class="pl-s">"[Answer 1 or Answer 2]"</span>,
        <span class="pl-s">"Explanation"</span>: <span class="pl-s">"[Summarize why this answer is the overall winner based on the three criteria]"</span>
    }}
}}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="---Role---
You are an expert tasked with evaluating two answers to the same question based on three criteria: **Comprehensiveness**, **Diversity**, and **Empowerment**.
---Goal---
You will evaluate two answers to the same question based on three criteria: **Comprehensiveness**, **Diversity**, and **Empowerment**.

- **Comprehensiveness**: How much detail does the answer provide to cover all aspects and details of the question?
- **Diversity**: How varied and rich is the answer in providing different perspectives and insights on the question?
- **Empowerment**: How well does the answer help the reader understand and make informed judgments about the topic?

For each criterion, choose the better answer (either Answer 1 or Answer 2) and explain why. Then, select an overall winner based on these three categories.

Here is the question:
{query}

Here are the two answers:

**Answer 1:**
{answer1}

**Answer 2:**
{answer2}

Evaluate both answers using the three criteria listed above and provide detailed explanations for each criterion.

Output your evaluation in the following JSON format:

{{
    &quot;Comprehensiveness&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Provide explanation here]&quot;
    }},
    &quot;Empowerment&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Provide explanation here]&quot;
    }},
    &quot;Overall Winner&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Summarize why this answer is the overall winner based on the three criteria]&quot;
    }}
}}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="16641625" _msthash="483">整体性能表</h3><a id="user-content-overall-performance-table" class="anchor" aria-label="永久链接：整体性能表" href="#overall-performance-table" _mstaria-label="1001312" _msthash="484"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<markdown-accessiblity-table data-catalyst=""><table>
<thead>
<tr>
<th></th>
<th><strong _msttexthash="3980548" _msthash="485">农业</strong></th>
<th></th>
<th><strong _msttexthash="6490094" _msthash="486">CS 系列</strong></th>
<th></th>
<th><strong _msttexthash="5079087" _msthash="487">法律</strong></th>
<th></th>
<th><strong _msttexthash="4798989" _msthash="488">混合</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td _msttexthash="5248555" _msthash="489">天真</td>
<td><strong _msttexthash="1918982" _msthash="490">光 RAG</strong></td>
<td _msttexthash="5248555" _msthash="491">天真</td>
<td><strong _msttexthash="1918982" _msthash="492">光 RAG</strong></td>
<td _msttexthash="5248555" _msthash="493">天真</td>
<td><strong _msttexthash="1918982" _msthash="494">光 RAG</strong></td>
<td _msttexthash="5248555" _msthash="495">天真</td>
<td><strong _msttexthash="1918982" _msthash="496">光 RAG</strong></td>
</tr>
<tr>
<td><strong _msttexthash="8806811" _msthash="497">全面性</strong></td>
<td _msttexthash="27274" _msthash="498">32.4%</td>
<td><strong _msttexthash="28327" _msthash="499">67.6%</strong></td>
<td _msttexthash="27898" _msthash="500">38.4%</td>
<td><strong _msttexthash="27703" _msthash="501">61.6%</strong></td>
<td _msttexthash="27508" _msthash="502">16.4%</td>
<td><strong _msttexthash="28093" _msthash="503">83.6%</strong></td>
<td _msttexthash="28418" _msthash="504">38.8%</td>
<td><strong _msttexthash="27183" _msthash="505">61.2%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="7730281" _msthash="506">多样性</strong></td>
<td _msttexthash="27547" _msthash="507">23.6%</td>
<td><strong _msttexthash="28054" _msthash="508">76.4%</strong></td>
<td _msttexthash="27378" _msthash="509">38.0%</td>
<td><strong _msttexthash="27027" _msthash="510">62.0%</strong></td>
<td _msttexthash="27456" _msthash="511">13.6%</td>
<td><strong _msttexthash="28145" _msthash="512">86.4%</strong></td>
<td _msttexthash="27274" _msthash="513">32.4%</td>
<td><strong _msttexthash="28327" _msthash="514">67.6%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="5067920" _msthash="515">授权</strong></td>
<td _msttexthash="27274" _msthash="516">32.4%</td>
<td><strong _msttexthash="28327" _msthash="517">67.6%</strong></td>
<td _msttexthash="28418" _msthash="518">38.8%</td>
<td><strong _msttexthash="27183" _msthash="519">61.2%</strong></td>
<td _msttexthash="27508" _msthash="520">16.4%</td>
<td><strong _msttexthash="28093" _msthash="521">83.6%</strong></td>
<td _msttexthash="27885" _msthash="522">42.8%</td>
<td><strong _msttexthash="27716" _msthash="523">57.2%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="4475380" _msthash="524">整体</strong></td>
<td _msttexthash="27274" _msthash="525">32.4%</td>
<td><strong _msttexthash="28327" _msthash="526">67.6%</strong></td>
<td _msttexthash="28418" _msthash="527">38.8%</td>
<td><strong _msttexthash="27183" _msthash="528">61.2%</strong></td>
<td _msttexthash="27144" _msthash="529">15.2%</td>
<td><strong _msttexthash="28457" _msthash="530">84.8%</strong></td>
<td _msttexthash="26637" _msthash="531">40.0%</td>
<td><strong _msttexthash="26819" _msthash="532">60.0%</strong></td>
</tr>
<tr>
<td></td>
<td _msttexthash="9284067" _msthash="533">RQ-RAG 系列</td>
<td><strong _msttexthash="1918982" _msthash="534">光 RAG</strong></td>
<td _msttexthash="9284067" _msthash="535">RQ-RAG 系列</td>
<td><strong _msttexthash="1918982" _msthash="536">光 RAG</strong></td>
<td _msttexthash="9284067" _msthash="537">RQ-RAG 系列</td>
<td><strong _msttexthash="1918982" _msthash="538">光 RAG</strong></td>
<td _msttexthash="9284067" _msthash="539">RQ-RAG 系列</td>
<td><strong _msttexthash="1918982" _msthash="540">光 RAG</strong></td>
</tr>
<tr>
<td><strong _msttexthash="8806811" _msthash="541">全面性</strong></td>
<td _msttexthash="27430" _msthash="542">31.6%</td>
<td><strong _msttexthash="28171" _msthash="543">68.4%</strong></td>
<td _msttexthash="28418" _msthash="544">38.8%</td>
<td><strong _msttexthash="27183" _msthash="545">61.2%</strong></td>
<td _msttexthash="27144" _msthash="546">15.2%</td>
<td><strong _msttexthash="28457" _msthash="547">84.8%</strong></td>
<td _msttexthash="27742" _msthash="548">39.2%</td>
<td><strong _msttexthash="27859" _msthash="549">60.8%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="7730281" _msthash="550">多样性</strong></td>
<td _msttexthash="27651" _msthash="551">29.2%</td>
<td><strong _msttexthash="27950" _msthash="552">70.8%</strong></td>
<td _msttexthash="27742" _msthash="553">39.2%</td>
<td><strong _msttexthash="27859" _msthash="554">60.8%</strong></td>
<td _msttexthash="27248" _msthash="555">11.6%</td>
<td><strong _msttexthash="28353" _msthash="556">88.4%</strong></td>
<td _msttexthash="27586" _msthash="557">30.8%</td>
<td><strong _msttexthash="28015" _msthash="558">69.2%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="5067920" _msthash="559">授权</strong></td>
<td _msttexthash="27430" _msthash="560">31.6%</td>
<td><strong _msttexthash="28171" _msthash="561">68.4%</strong></td>
<td _msttexthash="27690" _msthash="562">36.4%</td>
<td><strong _msttexthash="27911" _msthash="563">63.6%</strong></td>
<td _msttexthash="27144" _msthash="564">15.2%</td>
<td><strong _msttexthash="28457" _msthash="565">84.8%</strong></td>
<td _msttexthash="27365" _msthash="566">42.4%</td>
<td><strong _msttexthash="28236" _msthash="567">57.6%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="4475380" _msthash="568">整体</strong></td>
<td _msttexthash="27274" _msthash="569">32.4%</td>
<td><strong _msttexthash="28327" _msthash="570">67.6%</strong></td>
<td _msttexthash="27378" _msthash="571">38.0%</td>
<td><strong _msttexthash="27027" _msthash="572">62.0%</strong></td>
<td _msttexthash="27300" _msthash="573">14.4%</td>
<td><strong _msttexthash="28301" _msthash="574">85.6%</strong></td>
<td _msttexthash="26637" _msthash="575">40.0%</td>
<td><strong _msttexthash="26819" _msthash="576">60.0%</strong></td>
</tr>
<tr>
<td></td>
<td _msttexthash="5098405" _msthash="577">海 德</td>
<td><strong _msttexthash="1918982" _msthash="578">光 RAG</strong></td>
<td _msttexthash="5098405" _msthash="579">海 德</td>
<td><strong _msttexthash="1918982" _msthash="580">光 RAG</strong></td>
<td _msttexthash="5098405" _msthash="581">海 德</td>
<td><strong _msttexthash="1918982" _msthash="582">光 RAG</strong></td>
<td _msttexthash="5098405" _msthash="583">海 德</td>
<td><strong _msttexthash="1918982" _msthash="584">光 RAG</strong></td>
</tr>
<tr>
<td><strong _msttexthash="8806811" _msthash="585">全面性</strong></td>
<td _msttexthash="27079" _msthash="586">26.0%</td>
<td><strong _msttexthash="27326" _msthash="587">74.0%</strong></td>
<td _msttexthash="27521" _msthash="588">41.6%</td>
<td><strong _msttexthash="28080" _msthash="589">58.4%</strong></td>
<td _msttexthash="28119" _msthash="590">26.8%</td>
<td><strong _msttexthash="27482" _msthash="591">73.2%</strong></td>
<td _msttexthash="27157" _msthash="592">40.4%</td>
<td><strong _msttexthash="28444" _msthash="593">59.6%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="7730281" _msthash="594">多样性</strong></td>
<td _msttexthash="26871" _msthash="595">24.0%</td>
<td><strong _msttexthash="27534" _msthash="596">76.0%</strong></td>
<td _msttexthash="28418" _msthash="597">38.8%</td>
<td><strong _msttexthash="27183" _msthash="598">61.2%</strong></td>
<td _msttexthash="26455" _msthash="599">20.0%</td>
<td><strong _msttexthash="27001" _msthash="600">80.0%</strong></td>
<td _msttexthash="27274" _msthash="601">32.4%</td>
<td><strong _msttexthash="28327" _msthash="602">67.6%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="5067920" _msthash="603">授权</strong></td>
<td _msttexthash="27235" _msthash="604">25.2%</td>
<td><strong _msttexthash="28366" _msthash="605">74.8%</strong></td>
<td _msttexthash="27677" _msthash="606">40.8%</td>
<td><strong _msttexthash="27924" _msthash="607">59.2%</strong></td>
<td _msttexthash="27079" _msthash="608">26.0%</td>
<td><strong _msttexthash="27326" _msthash="609">74.0%</strong></td>
<td _msttexthash="27261" _msthash="610">46.0%</td>
<td><strong _msttexthash="27144" _msthash="611">54.0%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="4475380" _msthash="612">整体</strong></td>
<td _msttexthash="27911" _msthash="613">24.8%</td>
<td><strong _msttexthash="27690" _msthash="614">75.2%</strong></td>
<td _msttexthash="27521" _msthash="615">41.6%</td>
<td><strong _msttexthash="28080" _msthash="616">58.4%</strong></td>
<td _msttexthash="27599" _msthash="617">26.4%</td>
<td><strong _msttexthash="28002" _msthash="618">73.6%</strong></td>
<td _msttexthash="27365" _msthash="619">42.4%</td>
<td><strong _msttexthash="28236" _msthash="620">57.6%</strong></td>
</tr>
<tr>
<td></td>
<td _msttexthash="4594239" _msthash="621">图形 RAG</td>
<td><strong _msttexthash="1918982" _msthash="622">光 RAG</strong></td>
<td _msttexthash="4594239" _msthash="623">图形 RAG</td>
<td><strong _msttexthash="1918982" _msthash="624">光 RAG</strong></td>
<td _msttexthash="4594239" _msthash="625">图形 RAG</td>
<td><strong _msttexthash="1918982" _msthash="626">光 RAG</strong></td>
<td _msttexthash="4594239" _msthash="627">图形 RAG</td>
<td><strong _msttexthash="1918982" _msthash="628">光 RAG</strong></td>
</tr>
<tr>
<td><strong _msttexthash="8806811" _msthash="629">全面性</strong></td>
<td _msttexthash="27937" _msthash="630">45.6%</td>
<td><strong _msttexthash="27664" _msthash="631">54.4%</strong></td>
<td _msttexthash="27989" _msthash="632">48.4%</td>
<td><strong _msttexthash="27612" _msthash="633">51.6%</strong></td>
<td _msttexthash="27989" _msthash="634">48.4%</td>
<td><strong _msttexthash="27612" _msthash="635">51.6%</strong></td>
<td><strong _msttexthash="27248" _msthash="636">50.4%</strong></td>
<td _msttexthash="28353" _msthash="637">49.6%</td>
</tr>
<tr>
<td><strong _msttexthash="7730281" _msthash="638">多样性</strong></td>
<td _msttexthash="27703" _msthash="639">22.8%</td>
<td><strong _msttexthash="27898" _msthash="640">77.2%</strong></td>
<td _msttexthash="27677" _msthash="641">40.8%</td>
<td><strong _msttexthash="27924" _msthash="642">59.2%</strong></td>
<td _msttexthash="27599" _msthash="643">26.4%</td>
<td><strong _msttexthash="28002" _msthash="644">73.6%</strong></td>
<td _msttexthash="27170" _msthash="645">36.0%</td>
<td><strong _msttexthash="27235" _msthash="646">64.0%</strong></td>
</tr>
<tr>
<td><strong _msttexthash="5067920" _msthash="647">授权</strong></td>
<td _msttexthash="27001" _msthash="648">41.2%</td>
<td><strong _msttexthash="28600" _msthash="649">58.8%</strong></td>
<td _msttexthash="27417" _msthash="650">45.2%</td>
<td><strong _msttexthash="28184" _msthash="651">54.8%</strong></td>
<td _msttexthash="27729" _msthash="652">43.6%</td>
<td><strong _msttexthash="27872" _msthash="653">56.4%</strong></td>
<td><strong _msttexthash="27768" _msthash="654">50.8%</strong></td>
<td _msttexthash="27833" _msthash="655">49.2%</td>
</tr>
<tr>
<td><strong _msttexthash="4475380" _msthash="656">整体</strong></td>
<td _msttexthash="27417" _msthash="657">45.2%</td>
<td><strong _msttexthash="28184" _msthash="658">54.8%</strong></td>
<td _msttexthash="27469" _msthash="659">48.0%</td>
<td><strong _msttexthash="26936" _msthash="660">52.0%</strong></td>
<td _msttexthash="27625" _msthash="661">47.2%</td>
<td><strong _msttexthash="27976" _msthash="662">52.8%</strong></td>
<td><strong _msttexthash="27248" _msthash="663">50.4%</strong></td>
<td _msttexthash="28353" _msthash="664">49.6%</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="5805579" _msthash="665">繁殖</h2><a id="user-content-reproduce" class="anchor" aria-label="永久链接：重现" href="#reproduce" _mstaria-label="403364" _msthash="666"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font _mstmutation="1" _msttexthash="57250804" _msthash="667">所有代码都可以在目录中找到。</font><code>./reproduce</code></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="32729970" _msthash="668">步骤 0 提取唯一上下文</h3><a id="user-content-step-0-extract-unique-contexts" class="anchor" aria-label="永久链接： Step-0 Extract Unique Contexts" href="#step-0-extract-unique-contexts" _mstaria-label="1229696" _msthash="669"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="122346510" _msthash="670">首先，我们需要在数据集中提取独特的上下文。</p>
<details>
<summary _msttexthash="4704375" _msthash="671">法典</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">def</span> <span class="pl-en">extract_unique_contexts</span>(<span class="pl-s1">input_directory</span>, <span class="pl-s1">output_directory</span>):

    <span class="pl-s1">os</span>.<span class="pl-c1">makedirs</span>(<span class="pl-s1">output_directory</span>, <span class="pl-s1">exist_ok</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)

    <span class="pl-s1">jsonl_files</span> <span class="pl-c1">=</span> <span class="pl-s1">glob</span>.<span class="pl-c1">glob</span>(<span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">join</span>(<span class="pl-s1">input_directory</span>, <span class="pl-s">'*.jsonl'</span>))
    <span class="pl-en">print</span>(<span class="pl-s">f"Found <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-en">len</span>(<span class="pl-s1">jsonl_files</span>)<span class="pl-kos">}</span></span> JSONL files."</span>)

    <span class="pl-k">for</span> <span class="pl-s1">file_path</span> <span class="pl-c1">in</span> <span class="pl-s1">jsonl_files</span>:
        <span class="pl-s1">filename</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">basename</span>(<span class="pl-s1">file_path</span>)
        <span class="pl-s1">name</span>, <span class="pl-s1">ext</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">splitext</span>(<span class="pl-s1">filename</span>)
        <span class="pl-s1">output_filename</span> <span class="pl-c1">=</span> <span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">name</span><span class="pl-kos">}</span></span>_unique_contexts.json"</span>
        <span class="pl-s1">output_path</span> <span class="pl-c1">=</span> <span class="pl-s1">os</span>.<span class="pl-c1">path</span>.<span class="pl-c1">join</span>(<span class="pl-s1">output_directory</span>, <span class="pl-s1">output_filename</span>)

        <span class="pl-s1">unique_contexts_dict</span> <span class="pl-c1">=</span> {}

        <span class="pl-en">print</span>(<span class="pl-s">f"Processing file: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">filename</span><span class="pl-kos">}</span></span>"</span>)

        <span class="pl-k">try</span>:
            <span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s1">file_path</span>, <span class="pl-s">'r'</span>, <span class="pl-s1">encoding</span><span class="pl-c1">=</span><span class="pl-s">'utf-8'</span>) <span class="pl-k">as</span> <span class="pl-s1">infile</span>:
                <span class="pl-k">for</span> <span class="pl-s1">line_number</span>, <span class="pl-s1">line</span> <span class="pl-c1">in</span> <span class="pl-en">enumerate</span>(<span class="pl-s1">infile</span>, <span class="pl-s1">start</span><span class="pl-c1">=</span><span class="pl-c1">1</span>):
                    <span class="pl-s1">line</span> <span class="pl-c1">=</span> <span class="pl-s1">line</span>.<span class="pl-c1">strip</span>()
                    <span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">line</span>:
                        <span class="pl-k">continue</span>
                    <span class="pl-k">try</span>:
                        <span class="pl-s1">json_obj</span> <span class="pl-c1">=</span> <span class="pl-s1">json</span>.<span class="pl-c1">loads</span>(<span class="pl-s1">line</span>)
                        <span class="pl-s1">context</span> <span class="pl-c1">=</span> <span class="pl-s1">json_obj</span>.<span class="pl-c1">get</span>(<span class="pl-s">'context'</span>)
                        <span class="pl-k">if</span> <span class="pl-s1">context</span> <span class="pl-c1">and</span> <span class="pl-s1">context</span> <span class="pl-c1"><span class="pl-c1">not</span> <span class="pl-c1">in</span></span> <span class="pl-s1">unique_contexts_dict</span>:
                            <span class="pl-s1">unique_contexts_dict</span>[<span class="pl-s1">context</span>] <span class="pl-c1">=</span> <span class="pl-c1">None</span>
                    <span class="pl-k">except</span> <span class="pl-s1">json</span>.<span class="pl-c1">JSONDecodeError</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
                        <span class="pl-en">print</span>(<span class="pl-s">f"JSON decoding error in file <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">filename</span><span class="pl-kos">}</span></span> at line <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">line_number</span><span class="pl-kos">}</span></span>: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">except</span> <span class="pl-v">FileNotFoundError</span>:
            <span class="pl-en">print</span>(<span class="pl-s">f"File not found: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">filename</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-k">continue</span>
        <span class="pl-k">except</span> <span class="pl-v">Exception</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
            <span class="pl-en">print</span>(<span class="pl-s">f"An error occurred while processing file <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">filename</span><span class="pl-kos">}</span></span>: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-k">continue</span>

        <span class="pl-s1">unique_contexts_list</span> <span class="pl-c1">=</span> <span class="pl-en">list</span>(<span class="pl-s1">unique_contexts_dict</span>.<span class="pl-c1">keys</span>())
        <span class="pl-en">print</span>(<span class="pl-s">f"There are <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-en">len</span>(<span class="pl-s1">unique_contexts_list</span>)<span class="pl-kos">}</span></span> unique `context` entries in the file <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">filename</span><span class="pl-kos">}</span></span>."</span>)

        <span class="pl-k">try</span>:
            <span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s1">output_path</span>, <span class="pl-s">'w'</span>, <span class="pl-s1">encoding</span><span class="pl-c1">=</span><span class="pl-s">'utf-8'</span>) <span class="pl-k">as</span> <span class="pl-s1">outfile</span>:
                <span class="pl-s1">json</span>.<span class="pl-c1">dump</span>(<span class="pl-s1">unique_contexts_list</span>, <span class="pl-s1">outfile</span>, <span class="pl-s1">ensure_ascii</span><span class="pl-c1">=</span><span class="pl-c1">False</span>, <span class="pl-s1">indent</span><span class="pl-c1">=</span><span class="pl-c1">4</span>)
            <span class="pl-en">print</span>(<span class="pl-s">f"Unique `context` entries have been saved to: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">output_filename</span><span class="pl-kos">}</span></span>"</span>)
        <span class="pl-k">except</span> <span class="pl-v">Exception</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
            <span class="pl-en">print</span>(<span class="pl-s">f"An error occurred while saving to the file <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">output_filename</span><span class="pl-kos">}</span></span>: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)

    <span class="pl-en">print</span>(<span class="pl-s">"All files have been processed."</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="def extract_unique_contexts(input_directory, output_directory):

    os.makedirs(output_directory, exist_ok=True)

    jsonl_files = glob.glob(os.path.join(input_directory, '*.jsonl'))
    print(f&quot;Found {len(jsonl_files)} JSONL files.&quot;)

    for file_path in jsonl_files:
        filename = os.path.basename(file_path)
        name, ext = os.path.splitext(filename)
        output_filename = f&quot;{name}_unique_contexts.json&quot;
        output_path = os.path.join(output_directory, output_filename)

        unique_contexts_dict = {}

        print(f&quot;Processing file: {filename}&quot;)

        try:
            with open(file_path, 'r', encoding='utf-8') as infile:
                for line_number, line in enumerate(infile, start=1):
                    line = line.strip()
                    if not line:
                        continue
                    try:
                        json_obj = json.loads(line)
                        context = json_obj.get('context')
                        if context and context not in unique_contexts_dict:
                            unique_contexts_dict[context] = None
                    except json.JSONDecodeError as e:
                        print(f&quot;JSON decoding error in file {filename} at line {line_number}: {e}&quot;)
        except FileNotFoundError:
            print(f&quot;File not found: {filename}&quot;)
            continue
        except Exception as e:
            print(f&quot;An error occurred while processing file {filename}: {e}&quot;)
            continue

        unique_contexts_list = list(unique_contexts_dict.keys())
        print(f&quot;There are {len(unique_contexts_list)} unique `context` entries in the file {filename}.&quot;)

        try:
            with open(output_path, 'w', encoding='utf-8') as outfile:
                json.dump(unique_contexts_list, outfile, ensure_ascii=False, indent=4)
            print(f&quot;Unique `context` entries have been saved to: {output_filename}&quot;)
        except Exception as e:
            print(f&quot;An error occurred while saving to the file {output_filename}: {e}&quot;)

    print(&quot;All files have been processed.&quot;)
" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="24149840" _msthash="672">步骤 1 插入上下文</h3><a id="user-content-step-1-insert-contexts" class="anchor" aria-label="永久链接：步骤 1 插入上下文" href="#step-1-insert-contexts" _mstaria-label="846560" _msthash="673"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="125710572" _msthash="674">对于提取的上下文，我们将它们插入到 LightRAG 系统中。</p>
<details>
<summary _msttexthash="4704375" _msthash="675">法典</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">def</span> <span class="pl-en">insert_text</span>(<span class="pl-s1">rag</span>, <span class="pl-s1">file_path</span>):
    <span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s1">file_path</span>, <span class="pl-s1">mode</span><span class="pl-c1">=</span><span class="pl-s">'r'</span>) <span class="pl-k">as</span> <span class="pl-s1">f</span>:
        <span class="pl-s1">unique_contexts</span> <span class="pl-c1">=</span> <span class="pl-s1">json</span>.<span class="pl-c1">load</span>(<span class="pl-s1">f</span>)

    <span class="pl-s1">retries</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span>
    <span class="pl-s1">max_retries</span> <span class="pl-c1">=</span> <span class="pl-c1">3</span>
    <span class="pl-k">while</span> <span class="pl-s1">retries</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">max_retries</span>:
        <span class="pl-k">try</span>:
            <span class="pl-s1">rag</span>.<span class="pl-c1">insert</span>(<span class="pl-s1">unique_contexts</span>)
            <span class="pl-k">break</span>
        <span class="pl-k">except</span> <span class="pl-v">Exception</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
            <span class="pl-s1">retries</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span>
            <span class="pl-en">print</span>(<span class="pl-s">f"Insertion failed, retrying (<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">retries</span><span class="pl-kos">}</span></span>/<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">max_retries</span><span class="pl-kos">}</span></span>), error: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)
            <span class="pl-s1">time</span>.<span class="pl-c1">sleep</span>(<span class="pl-c1">10</span>)
    <span class="pl-k">if</span> <span class="pl-s1">retries</span> <span class="pl-c1">==</span> <span class="pl-s1">max_retries</span>:
        <span class="pl-en">print</span>(<span class="pl-s">"Insertion failed after exceeding the maximum number of retries"</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="def insert_text(rag, file_path):
    with open(file_path, mode='r') as f:
        unique_contexts = json.load(f)

    retries = 0
    max_retries = 3
    while retries < max_retries:
        try:
            rag.insert(unique_contexts)
            break
        except Exception as e:
            retries += 1
            print(f&quot;Insertion failed, retrying ({retries}/{max_retries}), error: {e}&quot;)
            time.sleep(10)
    if retries == max_retries:
        print(&quot;Insertion failed after exceeding the maximum number of retries&quot;)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="33797179" _msthash="676">第 2 步：生成查询</h3><a id="user-content-step-2-generate-queries" class="anchor" aria-label="永久链接：步骤 2 生成查询" href="#step-2-generate-queries" _mstaria-label="879307" _msthash="677"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="475048769" _msthash="678">我们从数据集中每个上下文的第一部分和后半部分提取标记，然后将它们组合为数据集描述以生成查询。</p>
<details>
<summary _msttexthash="4704375" _msthash="679">法典</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s1">tokenizer</span> <span class="pl-c1">=</span> <span class="pl-v">GPT2Tokenizer</span>.<span class="pl-c1">from_pretrained</span>(<span class="pl-s">'gpt2'</span>)

<span class="pl-k">def</span> <span class="pl-en">get_summary</span>(<span class="pl-s1">context</span>, <span class="pl-s1">tot_tokens</span><span class="pl-c1">=</span><span class="pl-c1">2000</span>):
    <span class="pl-s1">tokens</span> <span class="pl-c1">=</span> <span class="pl-s1">tokenizer</span>.<span class="pl-c1">tokenize</span>(<span class="pl-s1">context</span>)
    <span class="pl-s1">half_tokens</span> <span class="pl-c1">=</span> <span class="pl-s1">tot_tokens</span> <span class="pl-c1">//</span> <span class="pl-c1">2</span>

    <span class="pl-s1">start_tokens</span> <span class="pl-c1">=</span> <span class="pl-s1">tokens</span>[<span class="pl-c1">1000</span>:<span class="pl-c1">1000</span> <span class="pl-c1">+</span> <span class="pl-s1">half_tokens</span>]
    <span class="pl-s1">end_tokens</span> <span class="pl-c1">=</span> <span class="pl-s1">tokens</span>[<span class="pl-c1">-</span>(<span class="pl-c1">1000</span> <span class="pl-c1">+</span> <span class="pl-s1">half_tokens</span>):<span class="pl-c1">1000</span>]

    <span class="pl-s1">summary_tokens</span> <span class="pl-c1">=</span> <span class="pl-s1">start_tokens</span> <span class="pl-c1">+</span> <span class="pl-s1">end_tokens</span>
    <span class="pl-s1">summary</span> <span class="pl-c1">=</span> <span class="pl-s1">tokenizer</span>.<span class="pl-c1">convert_tokens_to_string</span>(<span class="pl-s1">summary_tokens</span>)

    <span class="pl-k">return</span> <span class="pl-s1">summary</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="tokenizer = GPT2Tokenizer.from_pretrained('gpt2')

def get_summary(context, tot_tokens=2000):
    tokens = tokenizer.tokenize(context)
    half_tokens = tot_tokens // 2

    start_tokens = tokens[1000:1000 + half_tokens]
    end_tokens = tokens[-(1000 + half_tokens):1000]

    summary_tokens = start_tokens + end_tokens
    summary = tokenizer.convert_tokens_to_string(summary_tokens)

    return summary" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto" _msttexthash="14669837" _msthash="680">第 3 步 查询</h3><a id="user-content-step-3-query" class="anchor" aria-label="永久链接：Step-3 查询" href="#step-3-query" _mstaria-label="447681" _msthash="681"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="141504597" _msthash="682">对于第 2 步中生成的查询，我们将提取它们并查询 LightRAG。</p>
<details>
<summary _msttexthash="4704375" _msthash="683">法典</summary>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">def</span> <span class="pl-en">extract_queries</span>(<span class="pl-s1">file_path</span>):
    <span class="pl-k">with</span> <span class="pl-en">open</span>(<span class="pl-s1">file_path</span>, <span class="pl-s">'r'</span>) <span class="pl-k">as</span> <span class="pl-s1">f</span>:
        <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">f</span>.<span class="pl-c1">read</span>()

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">data</span>.<span class="pl-c1">replace</span>(<span class="pl-s">'**'</span>, <span class="pl-s">''</span>)

    <span class="pl-s1">queries</span> <span class="pl-c1">=</span> <span class="pl-s1">re</span>.<span class="pl-c1">findall</span>(<span class="pl-s">r'- Question \d+: (.+)'</span>, <span class="pl-s1">data</span>)

    <span class="pl-k">return</span> <span class="pl-s1">queries</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="def extract_queries(file_path):
    with open(file_path, 'r') as f:
        data = f.read()

    data = data.replace('**', '')

    queries = re.findall(r'- Question \d+: (.+)', data)

    return queries" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="19122688" _msthash="684">应用程序接口</h2><a id="user-content-api" class="anchor" aria-label="永久链接： API" href="#api" _mstaria-label="197821" _msthash="685"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="472874441" _msthash="686">LightRag 可以安装 API 支持，以提供快速 api 接口来执行数据上传和索引/Rag作/重新扫描输入文件夹等。</p>
<p dir="auto" _msttexthash="26135642" _msthash="687">文档可<a href="/HKUDS/LightRAG/blob/main/lightrag/api/README.md" _istranslated="1">在此处</a>找到</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="14802801" _msthash="688">图形查看器</h2><a id="user-content-graph-viewer" class="anchor" aria-label="永久链接：图表查看器" href="#graph-viewer" _mstaria-label="480025" _msthash="689"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="337748463" _msthash="690">LightRag 可以与 Tools support 一起安装，以添加额外的工具，例如 graphml 3d 可视化器。</p>
<p dir="auto" _msttexthash="26135642" _msthash="691">文档可<a href="/HKUDS/LightRAG/blob/main/lightrag/tools/lightrag_visualizer/README.md" _istranslated="1">在此处</a>找到</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="6455852" _msthash="692">Star 历史</h2><a id="user-content-star-history" class="anchor" aria-label="永久链接：Star History" href="#star-history" _mstaria-label="483132" _msthash="693"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<a href="https://star-history.com/#HKUDS/LightRAG&amp;Date" rel="nofollow">
 <themed-picture data-catalyst-inline="true" data-catalyst=""><picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://camo.githubusercontent.com/b6ed87f8202bd1ea192a0959cae29b291d27fefb1ee807d2997d987fb3027fd0/68747470733a2f2f6170692e737461722d686973746f72792e636f6d2f7376673f7265706f733d484b5544532f4c6967687452414726747970653d44617465267468656d653d6461726b" data-canonical-src="https://api.star-history.com/svg?repos=HKUDS/LightRAG&amp;type=Date&amp;theme=dark">
   <source media="(prefers-color-scheme: light)" srcset="https://camo.githubusercontent.com/a9fcbb38fe225c78351d5079194ad1c44d4336716eac78098aeb323afcd0be19/68747470733a2f2f6170692e737461722d686973746f72792e636f6d2f7376673f7265706f733d484b5544532f4c6967687452414726747970653d44617465" data-canonical-src="https://api.star-history.com/svg?repos=HKUDS/LightRAG&amp;type=Date">
   <img alt="Star 历史图表" src="https://camo.githubusercontent.com/a9fcbb38fe225c78351d5079194ad1c44d4336716eac78098aeb323afcd0be19/68747470733a2f2f6170692e737461722d686973746f72792e636f6d2f7376673f7265706f733d484b5544532f4c6967687452414726747970653d44617465" data-canonical-src="https://api.star-history.com/svg?repos=HKUDS/LightRAG&amp;type=Date" style="visibility:visible;max-width:100%;" _mstalt="315991" _msthash="694">
 </picture></themed-picture>
</a>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="6354283" _msthash="695">贡献</h2><a id="user-content-contribution" class="anchor" aria-label="永久链接： 贡献" href="#contribution" _mstaria-label="523965" _msthash="696"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto" _msttexthash="57965375" _msthash="697">感谢我们所有的贡献者！</p>
<a href="https://github.com/HKUDS/LightRAG/graphs/contributors">
  <img src="https://camo.githubusercontent.com/f6c0e619299f3b63fedc077c40d43ed35c6fa654914ec82a9369d36b40ef6349/68747470733a2f2f636f6e747269622e726f636b732f696d6167653f7265706f3d484b5544532f4c69676874524147" data-canonical-src="https://contrib.rocks/image?repo=HKUDS/LightRAG" style="max-width: 100%;">
</a>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto" _msttexthash="17204499" _msthash="698">🌟引文</h2><a id="user-content-citation" class="anchor" aria-label="永久链接： 🌟引文" href="#citation" _mstaria-label="25990185" _msthash="699"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-en">@<span class="pl-s1">article</span>{<span class="pl-s1">guo2024lightrag</span>,</span>
<span class="pl-en"><span class="pl-s1">title</span><span class="pl-c1">=</span>{<span class="pl-v">LightRAG</span>: <span class="pl-v">Simple</span> <span class="pl-c1">and</span> <span class="pl-v">Fast</span> <span class="pl-v">Retrieval</span><span class="pl-c1">-</span><span class="pl-v">Augmented</span> <span class="pl-v">Generation</span>},</span>
<span class="pl-en"><span class="pl-s1">author</span><span class="pl-c1">=</span>{<span class="pl-v">Zirui</span> <span class="pl-v">Guo</span> <span class="pl-c1">and</span> <span class="pl-v">Lianghao</span> <span class="pl-v">Xia</span> <span class="pl-c1">and</span> <span class="pl-v">Yanhua</span> <span class="pl-v">Yu</span> <span class="pl-c1">and</span> <span class="pl-v">Tu</span> <span class="pl-v">Ao</span> <span class="pl-c1">and</span> <span class="pl-v">Chao</span> <span class="pl-v">Huang</span>},</span>
<span class="pl-en"><span class="pl-s1">year</span><span class="pl-c1">=</span>{<span class="pl-c1">2024</span>},</span>
<span class="pl-en"><span class="pl-s1">eprint</span><span class="pl-c1">=</span>{<span class="pl-c1">2410.05779</span>},</span>
<span class="pl-en"><span class="pl-s1">archivePrefix</span><span class="pl-c1">=</span>{<span class="pl-s1">arXiv</span>},</span>
<span class="pl-en"><span class="pl-s1">primaryClass</span><span class="pl-c1">=</span>{<span class="pl-s1">cs</span>.<span class="pl-c1">IR</span>}</span>
<span class="pl-en">}</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="@article{guo2024lightrag,
title={LightRAG: Simple and Fast Retrieval-Augmented Generation},
author={Zirui Guo and Lianghao Xia and Yanhua Yu and Tu Ao and Chao Huang},
year={2024},
eprint={2410.05779},
archivePrefix={arXiv},
primaryClass={cs.IR}
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><strong _msttexthash="58141473" _msthash="700">感谢您对我们工作的关注！</strong></p>
</article></div>
